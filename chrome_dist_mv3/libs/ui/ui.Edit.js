
Std.model("ui.Edit",{b:"widget",c:"focus blur change input",e:{min:"infinite",max:"infinite",value:"",type:"text",echoMode:"normal",fontSize:null,maxLength:0,readOnly:!1,showState:!1,placeHolder:null,placeHolderClass:""},h:{inputNodeName:"input",placeHolderVisible:!0,lastValue:""},g:{enable:function(t){var e=this.DOMMap.input,i="disabled";!1===t?e.attr(i,i):e.removeAttr(i)}},i:{init:function(){var t=this,e=t.opts;t.DOMMap={},t.type(e.type),t.echoMode(e.echoMode),t._lastValue=e.value,t.call_opts({value:"",readOnly:!1,maxLength:0,placeHolder:null},!0),t.call_opts({fontSize:null},!0),t.initEvents()},initPlaceHolder:function(){var t=this,e=t.opts;return t.DOMMap.placeHolder||(t.DOMMap.placeHolder=newDiv("_placeHolder "+e.placeHolderClass).appendTo(t[0]).unselect(!0)),""!==e.value?t.placeHolderVisible(!1):t._placeHolderVisible=!0,t},initInput:function(t){var e=this,i=e.opts,n=e.DOMMap;return"password"===i.echoMode?n.input=new Std.dom(e._inputNodeName+"[type='password']"):n.input=newDom(e._inputNodeName),n.input.value(t),n.input.appendTo(e[0]).on("keydown keyup",Std.func(function(){e.placeHolderVisible(""===e.value())},5)),e},initInputEvent:function(){var o=this,s=o.opts;o[0].on("click",function(){o.DOMMap.input.focus()}),o.DOMMap.input.on("change",function(){o.emit("change",s.value)}).on("keydown",function(t){if(Std.mold.or("number int",o.type())){var e=t,i=this,t=e.which,n=e.keyCode,a=e.ctrlKey,l=i.value();if(e.shiftKey)e.preventDefault();else switch(!0){case 190===n&&!l.has(".")&&"int"!==s.type:isEmpty(l)&&i.value("0");break;case 173===n&&("infinite"===s.min||isNumber(s.min)&&s.min<0)&&!l.has("-"):case a&&(65===n||67===n):case 36<n&&n<41:case 173===t&&0===l.length:case 8===n||13===n:case 47<t&&t<58:case 95<t&&t<106:case 9===n:break;default:e.preventDefault()}}}).on("oninput"in o.DOMMap.input.dom?"input":"keyup",function(){var t=this.value();o.placeHolderVisible(""===t),Std.mold.or("number int",o.type())&&("infinite"!==s.min&&t<s.min?t=s.min:"infinite"!==s.max&&t>s.max&&(t=s.max),o.DOMMap.input.value(t=o.formatValue(t))),t!==o._lastValue&&o.emit("input",o._lastValue=s.value=t)})},initEvents:function(){var t=this,e=!1;return t[0].focussing(function(){0==e&&(e=!0,t.initInputEvent()),t.enable()&&(t.showState()&&t.removeClass("_state _success _error"),t.addClass("focused").emit("focus"),setTimeout(function(){t.DOMMap.input.focus()},1))},function(){t.enable()&&(t.showState()&&(t.valid()?t.addClass("_state _success"):t.addClass("_state _error")),t.removeClass("focused").emit("blur"),t.value(t.formatValue(t.DOMMap.input.value())))}),t[0].mouse(),t}},j:{showState:function(t){return this.opt("showState",t)},pattern:function(t){return this.opt("pattern",t)},select:function(){return this.DOMMap.input.select(),this},focus:function(){return this.DOMMap.input.focus(),this},blur:function(){return this.DOMMap.input.blur(),this},maxLength:function(t){var e=this;return e.opt("maxlength",t,function(){e.DOMMap.input.attr("maxlength",t)})},lineHeight:function(t){var e=this;return e.opt("lineHeight",t,function(){e.DOMMap.input.lineHeight(t)})},fontSize:function(t){var e=this.DOMMap;return null==t?e.input.css("font-size"):(e.input.css("font-size",t),e.placeHolder&&e.placeHolder.css("font-size",t),this)},value:function(t){var e=this,i=e.DOMMap;return void 0===t?e.formatValue(i.input.value()):(e.placeHolderVisible(""===(t=e.formatValue(t=null==t?"":t))),e.rendered?e._lastValue!==t&&(i.input.value(e._lastValue=t),e.emit("change",t)):i.input.value(e._lastValue=t),e)},type:function(t){return this.opt("type",t)},echoMode:function(t){var e=this,i=e.DOMMap;return this.opt("echoMode",t,function(){var t=e.rendered?e.value():e.opts.value;i.input&&(i.input.remove(),delete i.input),e.initInput(t)})},readOnly:function(t){var e=this.DOMMap.input;return this.opt("readOnly",t,function(){!0===t?e.attr("readOnly","readOnly"):e.attr("readOnly","")})},formatValue:function(t){var e=this.opts.type;return""!==t&&Std.mold.or("number int",e)&&!isNumeric(t)?this._lastValue:t},placeHolder:function(t){var e=this,i=e.DOMMap;return e.opt("placeHolder",t,function(){i.placeHolder||e.initPlaceHolder(),i.placeHolder.html(t)})},placeHolderVisible:function(t){var e=this,i=e.DOMMap;return void 0===t?e._placeHolderVisible:(t!==e._placeHolderVisible&&i.placeHolder&&i.placeHolder.visible(e._placeHolderVisible=t),e)},valid:function(){var t=this.type(),e=this.value(),i=this.validator();return!(Std.mold.or("number int",t)&&!isNumeric(e))&&(("int"!==t||!e.has("."))&&(!("email"===t&&!/\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(text))&&(isFunction(i)?i(e):i in Std.validator?Std.validator[i](e):Std.is(i,e))))}},k:function(t){t.init()},m:{rule:{content:"value"},html:{nodeName:["DIV"],create:function(t){this.value(t.html().trim())}}}}),Std.ui.module("LineEdit",{a:"ui.Edit",c:"focus blur change input open close",e:{level:3,label:null,labelClass:"",labelSide:"left",icon:"",iconSide:"left",dataList:null,listMaxHeight:300,minWidth:12,minHeight:12,iconWidth:22,iconHeight:22,defaultClass:"StdUI_LineEdit"},h:{inputNodeName:"input",listVisible:!1},g:{width:function(t){var e=this,i=e.opts,n=e.DOMMap,a=0,l=0,o=n.placeHolder,s=0,u=i.iconSide,d=i.labelSide,t=(isNumber(t)||(t=e.width()),(t-=e.boxSize.width-e.boxSize.extraWidth)-4);n.label&&(e=n.label.width()+e.labelBoxSize.width,"left"==d?a=2:"right"==d&&(l=2),o&&"left"==d&&(s=e+a),t-=e+2),n.icon&&("left"==u?a=2:"right"==u&&(l=2),o&&"left"==u&&(s+=i.iconWidth+a),n.label&&("left"==d&&"left"==u&&n.icon.marginLeft(2),"right"==d&&"right"==u&&n.icon.marginRight(2)),t-=i.iconWidth+2),0!==a&&n.input.marginLeft(a),0!==l&&n.input.marginRight(l),0!==s&&o.left(s),n.input.width(t)},height:function(t){var e=this,i=e.opts,n=e.DOMMap;isNumber(t)||(t=e.height()),t-=e.boxSize.height+e.boxSize.extraHeight,n.input.css({height:t,lineHeight:t}),n.placeHolder&&n.placeHolder.css({height:t}),n.label&&n.label.css({height:t}),n.icon&&i.iconHeight!=t&&n.icon.marginTop((t-i.iconHeight)/2),e[0].lineHeight(t)},destroy:function(){this.DOMMap.dataList&&this.DOMMap.dataList.remove(),this._hideDataList&&Std.dom(document).off("click",this._hideDataList)},init_boxSize:function(){this.DOMMap.label&&(this.labelBoxSize=this.DOMMap.label.boxSize())}},i:{initLabel:function(){var t=this.opts,e=this.DOMMap;return e.label=newDiv("_label "+t.labelClass).html(t.label),"left"==t.labelSide?e.label.prependTo(this):e.label.insertAfter(e.input),this},initIcon:function(){var t=this.opts,e=this.DOMMap;return e.icon=newDiv("_icon"),"left"==t.iconSide?e.icon.insertBefore(e.input):e.icon.insertAfter(e.input),Std.icon.update(e.icon,t.icon,{width:t.iconWidth,height:t.iconHeight}),this},initDataList:function(){var e=this,i=e.DOMMap,n=null;i.dataList=newDiv("StdUI_LineEdit_DataList").appendTo("body").unselect(!0).on("mouseenter mouseleave mousedown click",">._item",function(t){t=t.name;"mouseenter"===t?this.addClass("hover"):"mouseleave"===t?this.removeClass("hover"):"mousedown"===t?(n&&n.removeClass("selected"),n=this.addClass("selected")):"click"===t&&(i.dataList.hide(),e.value(this.text()))}),e[0].on("dblclick",function(){e._listVisible||isEmpty(e.filterList(e.value()))||e.open()}),e.on("input",function(t){""===t||isEmpty(e.filterList(t))?e.close():e.open()}),Std.dom(document).on("click",e._hideDataList=function(t){i.dataList.contains(t.target)||i.dataList.hide()})}},j:{dataList:function(t){var e=this;return e.opt("dataList",t,function(){e.DOMMap.dataList||e.initDataList()})},filterList:function(i){var n=!1,a=[],l=Std.dom.fragment(),t=this.DOMMap.dataList;return t?(t.clear(),Std.each(this.dataList(),function(t,e){e.has(i)&&(n=!0,a.push(e),l.appendChild(newDiv("_item").html(e).dom))}),n&&t.append(l),a):this},open:function(){var t=this,e=t[0].offset(),i=t.opts.listMaxHeight,n=e.y+t.height()+1,a=t.DOMMap.dataList,l=0;return a&&(a.removeStyle("height").show(),l=a.outerHeight(),isNumber(i)&&i<l&&a.outerHeight(l=i),n+l>Std.dom(window).height()&&(a.addClass("_top"),n=e.y-1-l),a.css({zIndex:++Std.ui.status.zIndex,left:e.x,top:n,outerWidth:t.width()}),t._listVisible||t.emit("open"),t._listVisible=!0),t},close:function(){var t=this.DOMMap.dataList;return t&&this._listVisible?(t.hide(),this.emit("close")):this},repaint:function(){return this.size(this.width(),this.height()),this},icon:function(t){var e=this;return e.opt("icon",t,function(){e.DOMMap.icon||Std.icon.update(e.DOMMap.icon,t)})},iconSide:function(t){return this.opt("iconSide",t)}},k:function(t,e){t.init(),e.label&&t.initLabel(),e.icon&&t.initIcon(),isArray(e.dataList)&&t.initDataList()},m:{rule:{content:"value"},html:{nodeName:["DIV"],create:function(t){var e=t.children();e&&0!=e.length?this.dataList(Std.each(e,function(t,e){return e.text()},!0)):this.value(t.html().trim())}}}}),Std.ui.module("TextEdit",{a:"ui.Edit",e:{level:4,minWidth:28,minHeight:28,defaultClass:"StdUI_TextEdit"},h:{inputNodeName:"textarea"},g:{height:function(t){isNumber(t)&&this.DOMMap.input.height(t-this.boxSize.height-this.boxSize.extraHeight)}}}),Std.dom.extend("editText",function(e){var i="StdUI_DOMEditText",n=this;if(n.hasData(i))return n;function t(t){var e,i=r.value();c.html(i),l.fixedWidth||(e=c.outerWidth(),null!==l.minWidth&&e<l.minWidth&&(e=l.minWidth),r.outerWidth(e)),l.fixedHeight||(e=c.outerHeight(),null!==l.minHeight&&e<l.minHeight&&(e=l.minHeight),r.outerHeight(e)),t&&isFunction(l.change)&&l.change.call(n,i)}var a,l=Std.extend({text:null,type:"default",apply:null,change:null,offsetParent:null,className:i,multiLine:!1,changeText:!0,top:null,left:null,width:null,height:null,minWidth:null,minHeight:null,fixedWidth:!1,fixedHeight:!1,textSelected:!0},e),o=(null==l.text&&(l.text=n.text()),0),s=0,u=0,d=0,r=newDom(l.multiLine?"textarea":"input",l.className).css({resize:"none",margin:0,padding:0}),c=newDom(n.nodeName(),n.className()).css({left:-999999,width:"auto",height:"auto",position:"absolute",visibility:"hidden"}).appendTo(n.parent()),h=function(t){var e=r.value();t&&r.is(t.target)||(r.remove(),c.remove(),n.removeData(i).show(),"fill"===l.type&&n.styleBack("position"),l.changeText&&n.html(e),isFunction(l.apply)&&l.apply.call(n,e,l.text),Std.dom(document).off("mousedown",h))};return"default"===l.type?r.insertAfter(n.hide()):(null!==l.top&&(o=l.top),null!==l.left&&(s=l.left),"fill"===l.type?("static"===n.css("position")&&n.styleTo("position","relative"),n.clear().append(r.css({position:"absolute",zIndex:Std.ui.status.zIndex+1,top:o,left:s}))):"cover"===l.type&&(a=n.offset(),r.appendTo("body").css({position:"absolute",zIndex:Std.ui.status.zIndex+1,top:null===l.top?a.y:o,left:null===l.left?a.x:s}))),Std.each("float fontFamily fontSize textIndent paddingLeft paddingRight paddingTop paddingBottom lineHeight",function(t,e){var i=n.css(e);c.css(e,i),r.css(e,i)}),l.css&&r.css(l.css),(isString(l.text)||isNumber(l.text))&&r.value(l.text),l.fixedWidth&&(u=null===l.width?n.outerWidth():l.width,"fill"===l.type&&(u-=n.css("borderLeftWidth")+n.css("borderRightWidth")),r.outerWidth(u)),l.fixedHeight&&(d=null===l.height?n.outerHeight():l.height,"fill"===l.type&&(d-=n.css("borderTopWidth")+n.css("borderBottomWidth")),r.outerHeight(d)),l.textSelected&&r.select(),t(),r.data(i,1).focus().on({blur:h,mousedown:function(t){t.stopPropagation()},keydown:function(t){13!==t.keyCode||!t.ctrlKey&&e.multiLine||h()}}).on("oninput"in n.dom?"input":"keydown",t),Std.dom(document).on("mousedown",h),r});
"undefined;"