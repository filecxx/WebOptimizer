
Std.ui.module("Accordion",{parent:"widget",events:"change remove expand collapse",option:{level:4,defaultClass:"StdUI_Accordion",switchType:"click",items:null,minWidth:100,template:null,overflow:"hidden",titleHeight:30,titleIconWidth:16,titleIconHeight:16,titleFontSize:null,titleBold:null,titleClass:"",titleTextClass:"",titleExpandedClass:"",titleTextAlign:null,titleArrow:!0,clientStretchable:!0,collapsible:!1,multiple:!1,autoClean:!0,deferRender:!0,contentPadding:5,selected:0},private:{allowUpdate:!0},extend:{height:function(){this.rendered&&this.update()},enable:function(i){this._items.items(function(t,e){e.enable(i)})},destroy:function(){this._items.items(function(t,e){e.destroy()}),this._items.clear(),this._expanded.clear()},render:function(){var i=this,t=i.opts,e=null;isNumber(t.selected)||isString(t.selected)?(e=i.items(t.selected))&&e.expand(!1):isArray(t.selected)&&Std.each(t.selected,function(t,e){i.select(e,!1)}),i.initEvents()},remove:function(t){var e=this,i=null;void 0!==t&&(i=e._items.items(t))&&(i.destroy(),e._items.remove(t),-1!==(t=e._expanded.indexOf(i))&&e._expanded.remove(t),e.rendered&&e.update(!1))}},initialize:{initItems:function(){var i=this,t=i.opts;i._items=Std.items(function(t,e){return t=i.createItem(t),isString(e.name)?t.name(e.name):isString(t.opts.name)&&(e.name=t.opts.name),i[0].insert(t[0],e.index),t}),null!==t.items&&i.append(t.items)},initEvents:function(){var n=this,l=n.opts;n[0].delegate("mouseenter","._item > ._title",function(t){var e=this.parent().index(),i=l.switchType;n.enable()&&("mouseenter"===i&&n._items.items(e)!==n._current&&n.select(e),this.mouse({auto:!1,unselect:!0,click:function(){"click"===i&&n.select(e)},dblclick:function(){"dblclick"===i&&n.select(e)}},t))})}},protected:{titlesHeight:function(){var i=0;return this.items(function(t,e){i+=e.opts.titleHeight+1}),i},computeClientHeight:function(){var t=this,e=Math.floor(t.height()-t.boxSize.height-t.boxSize.extraHeight-t.titlesHeight())+1;return 1<t._expanded.length?e/t._expanded.length:e},createItem:function(t){var e=this,i=e.opts;return new e._itemModule(Std.extend({iconWidth:i.titleIconWidth,iconHeight:i.titleIconHeight,titleFontSize:i.titleFontSize,titleBold:i.titleBold,titleHeight:i.titleHeight,titleClass:i.titleClass,titleArrow:i.titleArrow,titleTextClass:i.titleTextClass,titleTextAlign:i.titleTextAlign,titleExpandedClass:i.titleExpandedClass,contentPadding:i.contentPadding},t),e)},update:function(i,n){var t=this,e=t.opts;return"auto"!==e.height&&t._allowUpdate&&(t._allowUpdate=!1,e.multiple?Std.each(t._expanded,function(t,e){n!==e&&e.updateHeight(i)}):isEmpty(t._expanded)||t._expanded[0].updateHeight(!1),t._allowUpdate=!0),t}},public:{items:function(t,e){return this._items.items(t,e)},itemCount:function(){return this._items.length},expandedItem:function(){return this._expanded[0]||null},expandedItems:function(){return Array.from(this._expanded)},overflow:function(t){return this.opt("overflow",t,function(){this[0].css("overflow",t)})},expandAll:function(){var t=this;return t._allowUpdate=!1,t._items.items(function(t,e){e.expand()}),t._allowUpdate=!0,t},collapseAll:function(){var t=this;return t._allowUpdate=!1,t._items.items(function(t,e){e.collapse()}),t._allowUpdate=!0,t},template:function(t){var e=this.opts;return void 0===t?e.template:((t=isString(t)?Std.template(t):t)instanceof Std.template&&(e.template=t),this)},prepend:function(t,e){return this.insert(t,e,0)},insert:function(t,e,i){var n=this,t=n._items.insert(t,e,i);return n.rendered&&n.__final__("insert",function(){n.update(!1)}),t},append:function(t,e){var i=this,t=isArray(t)?Std.each(t,function(t,e){i._items.append(e)},!0):i._items.append(t,e);return i.rendered&&i.__final__("append",function(){i.update(!1)}),t},select:function(t,i){var e=this,n=e.opts,l=null;if(isObject(t))l=t;else if(!(l=e._items.items(t)))return e;t=l.expanded();return n.multiple?n.collapsible?t?l.collapse(i):l.expand(i):t||l.expand(i):(Std.each(e._expanded,function(t,e){l!==e&&e.collapse(i)}),n.collapsible?t?l.collapse(i):l.expand(i):t||l.expand(i),e.emit("change",e)),e},map:function(n){var l=this,a={};return l.items(function(t,e){var i=e.name(),e=e.content;e.rendered&&("layout"===e.opts.contentType?e.layout().map(function(t,e){isFunction(n)&&n.call(l,t,e,a),a[e]=t}):i&&(a[i]=e,isFunction(n)&&n.call(l,e,i,a)))}),isString(n)?a[n]||null:a},valid:function(){var t=this.opts.valueType;return"auto"===t||"array"===t||"map"===t?!1!==this.items(function(t,e){if(!1===e.content.valid())return!1}):this.valid.parent.call(this)},value:function(i){var t=this,e=t.opts,n="auto"===e.valueType?"array":e.valueType;return void 0===i?t.rendered?"array"===n?t.items(function(t,e){return e.content.value()},!0):"map"===n&&(i={})?(t.map(function(t,e){i[e]=t.value()}),i):e.value:e.value:(isArray(e.value=i)&&"array"===n?t.items(function(t,e){t<i.length&&e.content.value(i[t])}):isObject(i)&&"map"===n&&t.map(function(t,e){t.value(i[e])}),t)},clear:function(){return this._items.items(function(t,e){e.destroy()}),this._items.clear(),this._expanded.clear(),this.emit("clear")}},main:function(t,e){"hidden"!==e.overflow&&t.overflow(e.overflow),null!==e.template&&t.template(e.template),t._expanded=[],t._itemModule=Std.ui.modules.Accordion.itemModule,t.initItems()},support:{rule:{children:"append"},html:{nodeName:["DIV"],create:function(t){this.append(t.children("ul",function(t,e){var i,n,l,a,o=e.children("li");if(o&&!(o.length<2))return i=null,n=e.attr("std-content"),l=o[0],o=o[1],n&&"html"!==n?"layout"==n?(a=o.attr("std-ui"))&&Std.ui(a)&&(i={layout:Std.ui.build(o,!1)}):"iframe"==n?i={iframe:o.text()}:"data"==n&&(i=o.html().toObject()):i=o.html(),Std.extend({icon:l.attr("std-icon"),text:l.html(),content:i||{}},Std.options.get(e),3)}))}}}}),Std.ui.module("Accordion").itemModule=Std.module({e:{text:"title",icon:null,name:null,iconWidth:16,iconHeight:16,titleHeight:30,titleClass:"",titleTextClass:"",titleExpandedClass:"",titleFontSize:null,titleBold:null,titleTextAlign:null,titleArrow:!0,height:null,content:"",contentPadding:5},h:{expanded:!1,detached:!0},n:{initHeader:function(){var t=this.opts,e=this.DOMMap;isEmpty(t.icon)||(e.title.append(e.titleIcon=newDiv("_icon").css({width:t.iconWidth,height:t.iconHeight,marginTop:-t.iconHeight/2})),Std.icon.update(e.titleIcon,t.icon,{width:null,height:null})),e.title.append([e.titleText=newDiv("_text "+t.titleTextClass).lineHeight(t.titleHeight).html(t.text)]),isBool(t.titleBold)&&e.title.css("fontWeight",t.titleBold?"bold":"normal"),t.titleFontSize&&e.title.css("fontSize",t.titleFontSize+"px"),t.titleTextAlign&&e.title.css("textAlign",t.titleTextAlign),t.titleArrow&&(e.titleArrow=newDiv("_arrow").appendTo(e.title))},initClient:function(){var t=this,e=t.opts,i=null,n=e.content;isString(n)?i=Std.ui("widget",{html:n,tabIndex:null}):isWidget(n)?i=n:t.parent.opts.template?i=Std.ui("TemplateItem",{data:isObject(n)?n:{},template:t.parent.opts.template}):isObject(n)&&(i=Std.ui(n.ui||"widget",Std.extend({tabIndex:null},n))),(t.content=i).opts.padding=e.contentPadding,t.parent.opts.deferRender?i.appendTo(t.DOMMap.client):(t._detached=!1,t.DOMMap.client.appendTo(t[0]),i.renderTo(t.DOMMap.client))}},i:{animateClient:function(t,e){var i=this.DOMMap.client;i.css("overflow","hidden").animateTo({height:t},{duration:200,timingFunction:"ease"},function(){i.removeStyle("overflow"),e()})},updateHeight:function(t,e){function i(){!l.clientHeight&&"auto"===a.opts.height?n.DOMMap.client.removeStyle("height"):(n.DOMMap.client.height(o),n.content.height(o))}var n=this,l=n.opts,a=n.parent,o=0,o="auto"===a.opts.height?isNumber(l.clientHeight)?l.clientHeight:n.DOMMap.client.height():!1===a.opts.clientStretchable?n.DOMMap.client.height():a.computeClientHeight();!1===t?i():(e&&n.DOMMap.client.height(0),n.animateClient(o,i))},clientVisible:function(t){var e=this,i=e.DOMMap,n=i.client;return t?(i.client.css({height:"",position:"relative",visibility:"visible"}),e._detached&&(e[0].append(n),e._detached=!1),e.content.rendered||e.content.render()):e.parent.opts.autoClean?(n.detach(),e._detached=!0):i.client.css({visibility:"hidden",position:""}),e},destroy:function(){return this.DOMMap.client.destroy(),this.content.destroy(),this[0].destroy(),this[0]=null,this}},j:{expanded:function(){return this._expanded},index:function(){return this.parent._items.indexOf(this)},name:function(t){return this.opt("name",t)},text:function(t){return this.opt("text",t,function(){this.DOMMap.titleText.html(t)})},con:function(t){return this.opt("icon",t,function(){Std.icon.update(this.DOMMap.titleIcon,t)})},enable:function(t){return this.content.enable(t),this},expand:function(t){var e=this,i=e.opts;return e._expanded||(e[0].addClass("selected"),e.DOMMap.title.addClass(i.titleExpandedClass),e.parent._expanded.push(e.clientVisible(e._expanded=!0)),e.updateHeight(t,!0),e.parent.emit("expand",e),e.parent.opts.multiple&&e.parent.update(t,e)),e},collapse:function(t){function e(){i.clientVisible(!1)}var i=this,n=i.opts;return i._expanded&&(!1===t?e():i.animateClient(0,e),i[0].removeClass("selected"),i._expanded=!1,i.DOMMap.title.removeClass(n.titleExpandedClass),i.parent._expanded.remove(i.parent._expanded.indexOf(i)),i.parent.update(t).emit("collapse",i)),i}},k:function(t,e){var i=this;i.parent=e,i.DOMMap={title:newDiv("_title "+t.titleClass).height(t.titleHeight),client:newDiv("_client")},i[0]=newDiv("_item").append([i.DOMMap.title]),i.init_opts(t),i.initHeader(),i.initClient()}});
"undefined;"