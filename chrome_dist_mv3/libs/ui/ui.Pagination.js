
Std.ui.module("Pagination",{b:"widget",e:{defaultClass:"StdUI_Pagination",tabIndex:null,level:3,total:0,page:1,pageSize:10,pageCount:"auto",pageNumbers:!0,pageNumberSize:7,pageButtonSpacing:0,pageButtonClassName:"StdUI_Pagination_Button",text:"<b><?=page?></b> / <b><?=pageCount?></b><b style='margin-left: 10px'>total:</b><?=total?>",href:"",first:"«",last:"»",prev:"◀",next:"▶",align:"left",refresh:null,editable:!0,buttonTheme:"default",buttonAutoHide:!1},c:"change",g:{render:function(){var e=this,t=e._buttonGroup;t.left&&t.left.render(),t.pages&&t.pages.render(),t.right&&t.right.render(),e.refreshPages(),e.refreshText(),e.refreshList()},destroy:function(){var e=this,t=e._buttonGroup;e._pageList&&e._pageList.destroy(),t.left&&t.left.destroy(),t.pages&&t.pages.destroy(),t.right&&t.right.destroy()}},i:{pageHref:function(e){var t=this._hrefTpl;return t?t.build({page:e,pageSize:this.pageSize(),pageNumberSize:this.opts.pageNumberSize,pageCount:this.pageCount(),total:this.total()}):null}},n:{initEvents:function(){function t(){var e=this.ui();e.enable()&&!e.checked()&&setTimeout(function(){a.page(e.value())},1)}var a=this;a[0].on("mouseenter",".StdUI_Button",function(e){this.mouse({auto:!1,click:t},e)})},initDOMTree:function(){var e=this,t=e.opts,a=e.DOMMap={main:newDom("tr"),buttons:newDom("td"),text:newDom("td","_text")};e[0].append(newDom("table").attr({cellspacing:0,cellpadding:0}).append(newDom("tbody").append(a.main=newDom("tr")))),"left"===t.align?a.main.append([a.buttons.attr("align","left"),a.text.attr("align","right")]):"right"===t.align&&a.main.append([a.text.attr("align","left"),a.buttons.attr("align","right")])},initButtonGroup:function(){var e=this,t=e.opts,a=e._buttonGroup={};(t.first||t.prev)&&(a.left=Std.ui("ButtonGroup",{buttonTheme:t.buttonTheme,appendTo:e.DOMMap.buttons,spacing:0,buttonFocusedClass:null})),t.pageNumbers&&(a.pages=Std.ui("ButtonGroup",{buttonClassName:t.pageButtonClassName,buttonTheme:t.buttonTheme,appendTo:e.DOMMap.buttons,spacing:t.pageButtonSpacing,buttonFocusedClass:null})),(t.next||t.last)&&(a.right=Std.ui("ButtonGroup",{buttonTheme:t.buttonTheme,appendTo:e.DOMMap.buttons,spacing:0,buttonFocusedClass:null})),isEmpty(t.first)||a.left.append("first",t.first),isEmpty(t.prev)||a.left.append("prev",t.prev),isEmpty(t.next)||a.right.append("next",t.next),isEmpty(t.last)||a.right.append("last",t.last)}},j:{total:function(e){return this.opt("total",e,function(){this.rendered&&this.refreshPages().refreshText().refreshList()})},text:function(e){return this.opt("text",e,function(){this._textTpl=new Std.template(e),this.rendered&&this.refreshText()})},href:function(e){return this.opt("href",e,function(){this._hrefTpl=isEmpty(e)?null:new Std.template(e),this.rendered&&this.refreshPages()})},pageSize:function(e){return this.opt("pageSize",e,function(){this.rendered&&this.refreshPages().refreshText()})},pageNumberSize:function(e){return this.opt("pageNumberSize",e,function(){this.rendered&&this.refreshPages().refreshText()})},editable:function(e){var t=this;return t.opt("editable",e,function(){e?t.refreshList():t._pageList&&(t._pageList.destroy(),delete t._pageList)})},page:function(e){var t=this,a=t.opts,n=t._pageList;return void 0===e?int(a.page):((e=t.pageIndex(e))!=~~a.page&&((a.page=e=e<1?1:e)&&n&&e!==n.value()&&n.value(e),t.refreshPages().refreshText(),t.emit("change",e)),t)},pageIndex:function(e){var t=this;return"first"===e?e=1:"prev"===e?e=t.page()-1:"next"===e?e=t.page()+1:"last"===e&&(e=t.pageCount()),~~e},pageCount:function(e){var t=this.opts;return void 0===e?"auto"===t.pageCount?Math.ceil(t.total/t.pageSize):t.pageCount:(t.pageCount=e,this.refreshText().refreshList())},pageNumbers:function(e){var t=this,a=t.opts,n=a.page,i=t.pageCount(),r=a.pageNumberSize,s=Math.floor(r/2),o=[],u=0,p=0;if(isArray(e))a.pageNumbers=e,t.rendered&&t.refreshPages().refreshList();else if(void 0!==e)return t;if(isArray(a.pageNumbers))return a.pageNumbers;if(i<=r){for(var g=1;g<=i;g++)o.push(g);return o}for((p=(u=n-s<1?1:n-1+s<i?n-s:i-r+1)-1+r)>i&&(p=i);u<=p;)o.push(u++);return o},refreshText:function(){var e=this;return e.rendered&&e._textTpl&&e.DOMMap.text.html(e._textTpl.build({page:e.page(),pageSize:e.pageSize(),pageNumberSize:e.pageNumberSize(),pageCount:e.pageCount(),total:e.total()})),e},refreshList:function(){var n=this;return n.opts.editable&&(n._pageList||(n._pageList=Std.ui("ComboBox",{editable:!0,value:n.page(),renderTo:n.DOMMap.buttons,listAnimation:!1,width:60}),n._pageList.on("change",function(){var e=this.value(),t=n.pageHref(e);isEmpty(e)||(n.page(~~e),t&&Std.url.location(t))}).on("input",function(e){var t=n.pageCount();(e=~~e.trim())<1?n._pageList.value(1):t<e&&n._pageList.value(t)})),n._pageList.clear().append(function(){for(var e=[],t=1,a=n.pageCount();t<=a;t++)1e4<t&&t+1e4<a?t+=9999:1e3<t&&t+1e3<a?t+=999:100<t&&t+100<a&&(t+=99),e.push(t+"");return e}()),n._pageList.value(n.page())),n},refreshPages:function(){var r=this,e=r.opts,n=e.page,s=r._buttonGroup;if(!r.rendered)return r;var t=r.pageNumbers(),a=e.buttonAutoHide?"visible":"enable";return s.left&&s.left[a](1<n),s.right&&s.right[a](n<r.pageCount()),Std.each("first prev next last",function(e,t){var a=r.pageIndex(t),n=r.pageHref(a),i=null;e<2&&s.left?i=s.left.items(t):s.right&&(i=s.right.items(t)),i&&i.value(a).href(n)}),e.pageNumbers&&(t=Std.each(t,function(e,t){var a=isObject(t)?t:{text:t,href:r.pageHref(t)};return(a.value=t)===n&&(a.toggleable=!1,a.checkable=!0,a.checked=!0),a},!0),s.pages.clear().append(t)),r},repaint:function(){return this.refreshPages(),this.refreshText(),this.refreshList(),this},clear:function(){var e=this;return e.opts.pageNumbers&&e._buttonGroup.pages.clear(),e._pageList&&e._pageList.clear(),e}},k:function(e,t){t.change&&e.on("change",t.change),isString(t.text)&&e.text(t.text),isEmpty(t.href)||e.href(t.href),e.initDOMTree(),e.initButtonGroup(),e.initEvents()},m:{rule:{},html:{nodeName:["DIV"],create:function(e){e=e.children(function(e,t){return{href:t.attr("href"),text:t.text().trim()}});isEmpty(e)||this.pageNumbers(e)}}}}),Std.plugin.module("Pagination",{e:{dataPath:"",dataInterface:null},i:{bindUIDataSource:function(){var e=this,n=e.opts,a=e.owner.dataSource,i=e.pagination;return"data"===a.type()&&i.total(a.data.length),i.on("change",function(e){var t=n.dataInterface;isString(t)&&a.call(t,{total:i.total(),page:e,pageSize:i.pageSize(),pageCount:i.pageCount()})}),a.on("message",e._messageEvent=function(e){var a;isPlainObject(e.message)&&e.name===n.dataInterface&&(a=Std.mold.dataPath(e.message,n.dataPath),Std.each("total pageSize pageCount page",function(e,t){t in a&&(i.opts[t]=a[t])}),i.refreshPages().refreshText().refreshList())}),e}},j:{destroy:function(){this.owner.dataSource&&this._messageEvent&&this._messageEvent.off("message",this._messageEvent),this.pagination.destroy()}},k:function(e,t,a){e.pagination=Std.ui("Pagination",t),e.pagination.on("change",function(){e.emit("change",arguments,!0)}),e.pagination[0].css({display:"block"}),isWidget(a)&&(e.pagination.renderTo(a),a.boxSize.extraHeight+=e.pagination.height(),a.resize("height"),a.on("render",function(){a.dataSource&&e.bindUIDataSource()}))}});
"undefined;"