
Std.ui.module("Desktop_Item",{b:"Item",e:{type:"file",defaultClass:"StdUI_Desktop_Item",desktop:null,tabIndex:null,contextMenu:null},g:{render:function(){this.parent().plugin("drag",{}),this.call_opts({contextMenu:null},!0)},height:function(){var e=this,t=e.D,e=e.height()-e.boxSize.height-e.D.text.height()-10-3;t.icon.css({width:e,height:e})},destroy:function(){var e=this.contextMenu();isWidget(e)&&e.remove()}},j:{type:function(e){return this.opt("type",e)},desktop:function(e){return this.opt("desktop",e)},contextMenu:function(e){var t=this,n=t.opts;return void 0===e?n.contextMenu:(isWidget(e)?n.contextMenu=e:isObject(e)&&(n.contextMenu=Std.ui(e.ui||"Menu",e)),isWidget(n.contextMenu)&&(n.contextMenu.rendered||n.contextMenu.renderTo(t.desktop()),n.contextMenu.hide().on("itemPress",function(){this.hide()})),t)}}}),Std.ui.module("Desktop_Applications",{b:"widget",e:{defaultClass:"Desktop_Applications",boxSizing:"border-box",master:null,groups:null,visible:!1},h:{currentGroup:null},g:{visible:function(e){var t=this;!0===e&&(null===t._currentGroup&&t.showGroup("*"),t.toForeground().focus(),t.update())},render:function(){this.initEvents(),this.toForeground()},height:function(){this.update()},width:function(){this.update()}},i:{initEvents:function(){var t=this;t[0].on("keydown",function(e){27===e.keyCode&&t.hide()}).on("contextmenu",function(e){e.preventDefault()}),t[5].on("mouseenter","._group",function(e){this.mouse({auto:!1,click:function(){t.showGroup(this.data("groupName"))}},e)})},initElements:function(){var e=this;e[0].append(e[1]=newDiv("_main").append([e[2]=newDiv("_header").append([e[2.1]=newDiv("_search").append([e[2.2]=newDom("input").attr("placeholder","search..")])]),e[3]=newDiv("_body").append([e[4]=newDiv("_items"),e[5]=newDiv("_groups")])]))},createItem:function(e){var t=newDiv("_item").append([newDiv("_icon").append(newDom("img").attr("src",e.icon)),newDiv("_text").html(e.text||"")]);return this[4].append(t.data("option",e)),t}},j:{master:function(e){return this.opt("master",e)},update:function(){var e=this,t=e[1],n=t.width(),i=t.height();return t.css({top:(e.height()-i)/2,left:(e.width()-n)/2}),e[3].css({height:i-e[2].height()}),e[4].css({width:n-e[5].width()}),e},appendGroup:Std.func(function(e,t){var n=this,t=newDiv("_group").html(t).appendTo(n[5]).data("groupName",e);e in n._groups&&n.removeGroup(e),n._items[e]=[],n._groups[e]=t},{each:[isObject]}),insertGroup:function(){},removeGroup:function(e){var t=this;return t._groups[e].remove(),delete t._items[e],delete t._groups[e],t},showGroup:function(e){var n=this.clearItems();if("*"===e)Std.each(n._items,function(e,t){Std.each(t,function(e,t){n.createItem(t)})});else{if(!(e in n._groups))return n;Std.each(n._items[e],function(e,t){n.createItem(t)})}return n._currentGroup&&n._groups[n._currentGroup].removeClass("selected"),n._groups[n._currentGroup=e].addClass("selected"),n},append:Std.func(function(n,e){var i=this._items;return isArray(e)?Std.each(e,function(e,t){i[n].push(t)}):isObject(e)&&i[n].push(e),this},{each:[isObject]}),insert:function(){},clearItems:function(){return this[4].clear(),this}},k:function(e,t){e._items={},e._groups={},e.initElements(),e.appendGroup("*","All"),t.group&&e.appendGroup(t.group)}}),Std.ui.module("Desktop_ControlBar",{b:"widget",e:{level:2,master:null,height:40,defaultClass:"StdUI_Desktop_ControlBar",boxSizing:"border-box"},g:{render:function(){this.initLayout()},height:function(e){e-=this.boxSize.height;this.components.applicationsBtn.size(e,e)}},i:{initLayout:function(){var e=this.components;return this.layout({ui:"HBoxLayout",items:[e.applicationsBtn,{ui:"spacing",width:5},e.taskBar,e.tray,e.dateTimeView]}),this}},j:{master:function(e){return this.opt("master",e)},append:function(e,t){},insert:function(){}},k:function(e,t){var n=t.master;e.components={tray:Std.ui("Tray",{level:4,width:200,fixedWidth:!0}),taskBar:Std.ui("Desktop_TaskBar",{master:n}),dateTimeView:Std.ui("DateTimeView",{type:"time",fontSize:21}),applicationsBtn:Std.ui("Image",{className:"Std_Desktop_TaskButton",value:"images/startButton.png"})},e.components.applicationsBtn[0].mouse({click:function(){var e=n.applications;e.visible()?e.hide():(e.rendered||e.render(),e.show())}})}}),Std.ui.module("Desktop_Main",{b:"widget",e:{level:5,defaultClass:"StdUI_Desktop_Main",boxSizing:"border-box",itemWidth:96,itemHeight:96,width:800,height:600,items:null,master:null,wallpaper:null},h:{cursor:null,selected:null,cursorTimer:null,currentMenu:null},g:{render:function(){var e=this;e[0].unselect(!0).append(e[1]=newDiv("_background")),e.initDesktopMenu(),e.initContextMenu(),e.initDesktopItemMenu(),e.initEvents(),e.initDocEvents(),e.initKeyboard(),e.initSelection()},destroy:function(){this._docEvents&&Std.dom(document).off("mousedown",this._docEvents)},remove:function(e){isWidget(e)&&this.layout().removeChild(e)}},i:{initSelection:function(){function t(e){if(0==i)return d.show().css({width:0,height:0,zIndex:Std.ui.status.zIndex+1}),i=!0,void(o=setInterval(p,100));d.css({top:s=(c=e.pageY-l)<0?e.pageY:l,left:r=(u=e.pageX-a)<0?e.pageX:a,width:u=u<0?Math.abs(u):u,height:c=c<0?Math.abs(c):c})}var n=this,i=!1,o=null,s=0,r=0,u=0,c=0,a=0,l=0,d=newDiv("_selection").appendTo(n[0]),p=function(){n.layout().each(function(e,t){r<t.left()+t.width()&&s<t.top()+t.height()&&r+u>t.left()&&s+c>t.top()?n.select(t.item()):n.clearSelected(t.item())})};return n[1].mouse({down:function(e){1===e.which&&(a=e.pageX,l=e.pageY,n[0].on("mousemove",t))},up:function(){i=!1,d.hide(),clearInterval(o),n[0].off("mousemove",t)}}),n},initKeyboard:function(){var t=this;return t[0].on("keydown",function(e){switch(e.keyCode){case 9:break;case 13:t.executionSelected();break;case 27:t.clearSelected();break;case 46:t.deleteSelected();break;case 113:isEmpty(t._selected)||(t.rename(t._selected[0]),t.clearSelected());break;default:return}}),t},initDocEvents:function(){var n=this;return Std.dom(document).on("mousedown",n._docEvents=function(e){var e=e.target,t=n._currentMenu;t&&!t[0].contains(e)&&(t.hide(),n._currentMenu=null)}),n},deleteSelected:function(){var n=this,i=[],e=n._selected;return isEmpty(e)||(Std.each(n._selected,function(e,t){i.push(t.text())}),Std.ui("MessageBox",{type:"question",title:"delete",renderTo:n.master(),text:"are sure you want to do this? this file will be removed!",buttons:"yes no",className:"",defaultButton:"yes",detailedText:i.join(" , "),on:{yes:function(){Std.each(e,function(e,t){n.remove(t)}),e.clear()}}})),n},initEvents:function(){var n=this;n.master().on("mousedown",function(e){e=Std.dom(e.target);e.is(".StdUI_Desktop_Item")||e.parent(".StdUI_Desktop_Item")||n.clearSelected()}),n[0].on("mouseenter",".StdUI_Desktop_Item",function(e){var t=this.ui();this.mouse({auto:!1,unselect:!0,down:function(e){n.focus(),e.ctrlKey||n.clearSelected(),n._contextMenu.visible()&&n._contextMenu.hide(),n._selected.has(t)?1===e.which&&n.clearSelected(t):n.select(t),e.preventDefault()},dblclick:function(){n.executionSelected()}}).unselect(!0)})},initDesktopItemMenu:function(){var e=this;e._itemMenu=Std.ui("Menu",{renderTo:e,visible:!1,width:200,css:{position:"absolute"},animation:{visible:"StdUI_Desktop_Menu"},items:[{text:"Open",css:{fontWeight:"bold"},click:function(){e.executionSelected()}},{text:"Open With ... ",click:function(){}},{ui:"sep"},{text:"Cut (Ctrl+X)"},{text:"Copy (Ctrl+C)"},{text:"Paste (Ctrl+V)"},{ui:"sep"},{text:"Move To..."},{text:"Copy To..."},{text:"Rename...",click:function(){isEmpty(e._selected)||(e.rename(e._selected[0]),e.clearSelected())}},{text:"Delete (Delete)"},{ui:"sep"},{text:"Properties"}],on:{itemPress:function(){e._itemMenu.hide()}}})},initDesktopMenu:function(){var e=this;e._contextMenu=Std.ui("Menu",{renderTo:e,visible:!1,width:200,css:{position:"absolute"},animation:{visible:"StdUI_Desktop_Menu"},items:[{text:"Lock component",iconClass:"StdUI_Desktop_Icon _lock"},{ui:"sep"},{text:"Sort by",items:[{text:"Type"},{text:"Name (Asc)"},{text:"Name (Desc)"}]},{text:"Create",items:[]},{text:"Refresh",iconClass:"StdUI_Desktop_Icon _refresh",click:function(){e.layout().update()}},{text:"Lock",iconClass:"StdUI_Desktop_Icon _lock2"},{ui:"sep"},{text:"Show full screen (F11)",value:"fullScreen",iconClass:"StdUI_Desktop_Icon _fullScreen",click:function(){e.master().fullScreen()}}],on:{visible:function(){e.updateContextMenu()},itemPress:function(){e._contextMenu.hide()}}})},initContextMenu:function(){function n(e,t){var n,i,o,s;e.visible()&&r._currentMenu===e?e.hide():(e[0].css("position","absolute"),e.show(),n=t.pageX,i=t.pageY,o=e.width(),s=e.height(),n+o>r.width()&&(n=r.width()-o),i+s>r.height()&&(i-=s),e.toForeground().move(n,i).focus()),r._currentMenu=e,t.preventDefault()}var r=this;r[1].on("contextmenu",function(e){n(r._contextMenu,e)}),r[0].on("contextmenu",".StdUI_Desktop_Item",function(e){var t=this.ui();t.contextMenu()?n(t.contextMenu(),e):n(r._itemMenu,e)})}},j:{master:function(e){return this.opt("master",e)},executionSelected:function(){var n=this;return Std.each(n._selected,function(e,t){n.execution(t)}),n},select:function(e){return isWidget(e)&&!this._selected.has(e)&&(e[0].parent().css("zIndex",1),e.addClass("selected"),this._selected.push(e)),this},wallpaper:function(e){return this[1].backgroundImage(e),this},rename:function(e){var t=this,n=e.text(),i=newDom("span","_temp").appendTo(e[0]).css({visibility:"hidden",fontFamily:e.D.text.css("fontFamily")}),o=newDom("textarea").appendTo(e).on({mousedown:function(e){e.stopPropagation()},keydown:function(e){13==e.keyCode&&o.blur(),setTimeout(function(){i.html(o.value());var e=i.width(),t=i.height();o.css({width:e<10?10:e,height:t<18?18:t})},5),e.stopPropagation()},blur:function(){e.D.text.show(),i.remove(),o.remove(),e.text(o.value()),t.select(e).focus()}}).value(n).focus().select().css("fontFamily",e.D.text.css("fontFamily"));return e.D.text.hide(),t},clearSelected:function(e){var t,n=this._selected;return void 0===e?(Std.each(n,function(e,t){t[0].parent().removeStyle("z-index"),t.removeClass("selected")}),n.clear()):n.has(e)&&(t=n.indexOf(e),n.remove(t),e[0].parent().removeStyle("z-index"),e.removeClass("selected")),this},append:function(e){var n=this,i=n.layout();return isArray(e)?Std.each(e,function(e,t){i.append(Std.extend({ui:"Desktop_Item",desktop:n},t))}):isObject(e)&&i.append(Std.extend({ui:"Desktop_Item",desktop:n},e)),i.update(),n},updateContextMenu:function(){return this._contextMenu&&this._contextMenu.each(function(e,t){if("fullScreen"==t.value())return Std.dom("body").fullScreen()?t.text("Exit full screen (F11)"):t.text("Show full screen (F11)"),!0}),this},execution:function(e){var t=this,n=t.master();return clearTimeout(t._cursorTimer),t._cursorTimer=setTimeout(function(){n.cursor(null)},1e4),n.cursor("wait"),Std.dom("img",e).clone().css({position:"absolute",zIndex:2,left:e[0].offset().x,top:e[0].offset().y,width:e.width(),height:e.width()}).appendTo(t).animate("end").animate({0:{filter:"blur(0px)",opacity:.9,transform:"scale(0.9)"},to:{filter:"blur(8px)",opacity:0,transform:"scale(1.5)"}},{duration:600,timingFunction:"ease-out"},function(){this.remove()}),n.execution(e,function(){n.cursor(null)}),t}},k:function(e,t,n){e._selected=[],e.layout({ui:"GridLayout",spacing:10,rows:"auto",columns:"auto",autoFlow:"column",cellWidth:t.itemWidth,cellHeight:t.itemHeight,items:t.items})}}),Std.ui.module("Desktop_TaskBar",{b:"TaskBar",e:{level:4,master:null,boxSizing:"border-box"},g:{render:function(){this.initTaskMenu()},initTaskMenu:function(){var n=this;n.on("itemContextMenu",function(e,t){n._current=t})}},h:{current:null},i:{initProcessEvents:function(){var n=this;return n.master().on("createProcess",function(t){t.on("createWindow",function(e){n.bindProcessWindow(t,e)})}),n},initTaskMenuData:function(){var e=this;return e.taskMenu({width:200,items:[{text:"Restore",iconClass:"_restore",click:function(){e._current.value().restore()}},{text:"Minimize",iconClass:"_min",click:function(){e._current.value().minimize(!0)}},{text:"Maximize",iconClass:"_max",click:function(){e._current.value().maximize(!0)}},{ui:"sep"},{text:"More Action",items:[],enable:!1},{text:"New instance",enable:!1},{ui:"sep"},{text:"Close",iconClass:"_close",css:{fontWeight:"bold"},click:function(){e._current.value().close()}}],animation:{visible:"StdUI_Desktop_Menu"}})}},j:{master:function(){return this.opts.master},bindProcessWindow:function(e,t){var n=this,i=n.add({icon:t.titleIcon()||e.icon(),text:t.title()||e.name(),value:t});return i.on({select:function(e){!0===e&&t.focus()},active:function(e){t.emit(!1),t.minimize(!e),t.emit(!0)}}),t.on({focusin:function(){n.select(i,!0)},minimize:function(e){i.activated(!e)},destroy:function(){n.remove(i),n.update()}}),e.task=i,n.update()}},k:function(e,t){e.initTaskMenuData(),e.initProcessEvents()}}),Std.ui.module("Desktop",function(){var c=Std.module({a:"events",c:"create error message exit",e:{pid:0,url:null,name:"null",icon:"",address:"",argv:null,worker:null,master:null,fileExts:null},i:{initWorker:function(e){var t=this,n=e.main,i=null;return isString(n)&&(n=new Function("return "+n)()),isObject(e.mainWindow)&&(i=t.createWindow(e.mainWindow,!0)),isFunction(n)&&n(t,t.opts.argv,t.master(),i),t.emit("create",t.worker)},initApplication:function(){var n=this,i=!1,e=n.worker=new Worker(n.address()+"/index.js");e.onerror=function(e){console.log(e),n.emit("error",e)},e.onmessage=function(e){var t=e.data;isString(t)?"exit"==t&&n.exit():isObject(t)&&"init"===t.type&&0==i?(i=!0,t.packages?Std.use(t.packages,function(){n.initWorker(t)}):n.initWorker(t)):n.emit("message",e)}}},j:{postMessage:function(e){return this.worker.postMessage(e),this},createTray:function(e){var t=this.master().controlBar().components.tray,n=t.add(Std.extend({icon:this.icon(),name:this.name()},e));return t.update(),this.on("exit",function(){t.remove(n)}),n},createMainWindow:function(e){return this.createWindow(e||{},!0)},createWindow:function(e,t){var n=this,i=n.master(),o=n._windows,s=Std.ui("Window",Std.extend({value:n,title:t?n.name():"window - "+n.name(),titleIcon:n.icon(),className:"StdUI_Desktop_Window",renderTo:i.desktop(),animation:{minimize:"StdUI_Desktop_Window_Minimize",maximize:"StdUI_Desktop_Window_Maximize"}},e||{}));return s.on({destroy:function(){o.remove(o.indexOf(s)),!0===t&&n.exit()}}),o.push(s),n.emit("createWindow",s),s},exit:function(){var e=this.worker,t=this._windows;return Std.each(t,function(e,t){t.remove()}),e&&e.terminate(),t.clear(),this.emit("exit")}},k:function(e){e=this.init_opts(e);this._windows=[],e.on&&this.on(e.on),e.address&&this.initApplication()},l:function(e,n){Std.each("pid address name icon path master",function(e,t){n[t]=function(){return this.opts[t]}})}});return{b:"widget",c:"update createProcess",e:{level:4,width:1024,height:768,minWidth:600,minHeight:400,desktopItemWidth:100,desktopItemHeight:100,defaultClass:"StdUI_Desktop",boxSizing:"border-box",wallpaper:null},h:{processID:0,processes:null,componentLocked:!0,currentDesktopID:0},g:{render:function(){this.initLayout(),this.factorySetting(),this.initApplicationsView(),this.call_opts({wallpaper:null},!0)},destroy:function(){var t=this,n=t._processes;Std.each(n,function(e){t.terminateProcess(e),delete n[e]})}},i:{initLayout:function(){return this.layout(Std.ui("VBoxLayout",{spacing:0})),this},initApplicationsView:function(){this.applications=Std.ui("Desktop_Applications",{master:this,renderTo:this.desktop(),animation:{visible:"Desktop_Applications_Visible"}})},createMainDesktop:function(){var e=this.opts,e=Std.ui("Desktop_Main",{master:this,itemWidth:e.desktopItemWidth,itemHeight:e.desktopItemHeight});return this._desktops.push(e),e},createControlBar:function(){var e=Std.ui("Desktop_ControlBar",{master:this});return this._controlBars.push(e),e},createProcess:function(e,t,n,i,o){var s=this,r=++s._processID,i=i.split(" "),u=s._processes[r]=new c({PID:r,name:e,icon:t,path:n,argv:i,master:s,address:i[0]});return u.on({exit:function(){delete s._processes[r]},create:function(){Std.func(o).call(s,u)}}),s.emit("createProcess",u),u},terminateProcess:function(e){var t=this._processes;return isNumber(e)&&e in t&&(t[e].exit(),delete t[e]),this}},j:{process:function(e){return this._processes[e]||null},desktop:function(e){return this._desktops[void 0===e?0:e]},controlBar:function(e){return this._controlBars[void 0===e?0:e]},fullScreen:function(){var e=Std.dom("body");return e.fullScreen(!e.fullScreen())},wallpaper:function(n){return Std.each(this._desktops,function(e,t){t.wallpaper(n)}),this},cursor:function(e){var t=this,e="wait"===e?"_waiting":"";return isEmpty(e)?""==e&&t._cursor&&t.removeClass(t._cursor):t.addClass(t._cursor=e),t},execution:function(e,t){var n=null,i=null,o=null,s=null,r=null,u=null;return isWidget(e)?(n=e.type(),i=e.text(),o=e.icon(),u=e.value()):isObject(e)&&(n=e.type||"file",i=e.name,o=e.icon,s=e.path,u=e.address),"application"===n?isString(u)&&(r=this.createProcess(i,o,s,u,t)):"file"===n&&(n=Std.url.suffix(i))in this._fileExts&&(e=this._fileExts[n],r=this.createProcess(i,o,s,e.application+" "+u,t)),r},createFileExt:Std.func(function(e,t){return this._fileExts[e]={icon:t.icon,application:t.application,description:t.description}},{each:[isObject]}),removeFileExt:function(e){return delete this._fileExts[e],this},appendDesktopItem:function(e,t){var n;return e.type&&"file"!=e.type||e.icon||e.iconClass||!e.text||(n=Std.url.suffix(e.text))in this._fileExts&&(e.icon=this._fileExts[n].icon),this.desktop(t).append(e),this},factorySetting:function(){var e=this,t=e.createMainDesktop(),n=e.createControlBar();return e.layout().append([t,n]),e.updateLayout(),e}},k:function(e,t,n){e._desktops=[],e._controlBars=[],e._fileExts={},e._processes={},e._components={},isObject(t.fileExts)&&e.createFileExt(t.fileExts)}}});
"undefined;"