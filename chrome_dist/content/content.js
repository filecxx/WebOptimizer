
"use strict";var injected_script_loaded=!1,injected_script_callback=null,is_in_empty_frame=function(){var e=window.location.protocol;return!(window===window.parent||window.opener||e&&e.toLowerCase().startsWith("http"))}();is_in_empty_frame||content_injector.inject_script("content/content_injected.js",function(){injected_script_loaded=!0,injected_script_callback&&injected_script_callback()}),chrome.storage.local.get({settings:config.settings,replace_words:config.replace_words},e=>{var d,o,t,r,n,c;is_in_empty_frame||(config.settings=e.settings,config.replace_words=e.replace_words,content_replace_words.word_count=Object.keys(config.replace_words).length,d={ui_loaded:!1,ui_onload:null,ad_blocker_layer_removed:!1,body_overflow_removed:!1},o={auto_click:function(e){element_selector.select(function(e){t(function(){content_auto_click.create_rule(e)})},!0===e.from_popup)},ui_loaded:function(){Std.ui.status.zIndex=9999,d.ui_onload()}},t=function(e){if(d.ui_onload=e,d.ui_loaded)return d.ui_onload();content_injector.inject_css("../libs/ui/theme/all.css"),chrome.runtime.sendMessage({type:"load_ui"})},document.onmouseover=function(e){function t(e){e&&"none"===get_element_style(e,"user-select")&&(e.style["user-select"]="text")}var n=e.target,e=e.relatedTarget;if(config.settings.unlock_text_select_restriction&&(t(n),n!==e&&t(e)),config.settings.remove_anti_ad_blocker_layer){var e=n.innerHTML,o="hidden"===get_element_style(document.body,"overflow"),c=function(e){return!!e&&(-1!==(e=n.innerHTML.toLowerCase()).indexOf("ad")&&-1!==e.indexOf("blocker"))};if(o&&(c(e)||c(n.className))){for(var r=n,i=null;r!==document.body&&r!==document.documentElement&&(parseInt(get_element_style(r,"width"))>=document.body.offsetWidth-4&&(i=r),r=r.parentNode););i&&(d.ad_blocker_layer_removed=!0,d.body_overflow_removed=!0,i.parentNode.removeChild(i),document.body.style.overflow="visible")}o&&d.body_overflow_removed&&(document.body.style.overflow="visible")}},window.onload=function(){0!==content_replace_words.word_count&&document.body&&!function e(t){if(t)for(var n=t.childNodes,o=n.length;o--;){var c=n[o],r=c.nodeType;3===r?content_replace_words.replace_text_node(c):1!==r&&9!==r&&11!==r||e(c)}}(document.body);var e=document.documentElement||document.body;window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,e.addEventListener("DOMNodeInserted",function(e){e=e.target;3===e.nodeType?content_replace_words.replace_text_node(e):1===e.nodeType&&content_auto_click.exec_once(e)}),e.addEventListener("DOMCharacterDataModified",function(e){var t=e.target;3===t.nodeType&&e.newValue!==e.prevValue&&content_replace_words.replace_text_node(t)}),content_replace_words.replace_title(),content_auto_click.exec_once()},r=function(){window.postMessage({prefix:"@web_optimizer_settings",settings:config.settings})},n=function(e,t,n){e&&e.type in o&&o[e.type](e,t,n)},c=setInterval(function(){content_replace_words.weak_set=new WeakSet},500),chrome.runtime.onMessage.addListener(n),chrome.runtime.connect().onDisconnect.addListener(()=>{clearInterval(c),chrome.runtime.onMessage.removeListener(n)}),chrome.storage.onChanged.addListener(function(e,t){if(e.settings){for(var[n,{oldValue:o,newValue:c}]of Object.entries(e))o!==c&&(config.settings[n]=c,n);r()}else e.replace_words&&(config.replace_words=e.replace_words,content_replace_words.word_count=Object.keys(config.replace_words).length)}),chrome.runtime.sendMessage({type:"query_content_auto_clicks",url:window.location.href},function(e){e&&content_auto_click.update_rules(e)}),injected_script_loaded?r():injected_script_callback=r)});