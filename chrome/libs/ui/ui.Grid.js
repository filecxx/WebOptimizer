
!function(){var t=null,n=null,u=null,r=null,i=null,o=null,l=null,a=null,s=null,d=Std.ui.module("Grid",{b:"widget",c:"scroll clearRows clear dataSourceMessage selectionModeChange columnEvent rowEvent cellEvent cellEdit rowResizeStart rowResizeStop columnResizeStart columnResizeStop columnDropStart columnDropStop",e:{defaultClass:"StdUI_Grid",level:4,minWidth:120,minHeight:60,rows:null,rowHeight:30,rowCount:0,rowNumbers:!1,rowCheckable:!1,rowLabels:!1,rowResizable:!1,rowExtensible:!1,rowContentHeight:100,rowNumberWidth:40,rowLabelWidth:60,rowCheckBoxWidth:35,rowExpanderWidth:30,rowContextMenu:null,stripeRows:!1,verticalLine:!0,horizontalLine:!0,cellPadding:3,cellTextAlign:"left",cellEditable:!1,cellEditMode:"dblclick keypress",cellCoordText:"cell index <?=row?>:<?=col?>",cellContextMenu:null,mergedCells:null,columns:null,columnCount:0,columnHeight:29,columnWidth:80,columnPadding:3,columnTextAlign:"left",columnMenu:!1,columnDroppable:!1,columnResizable:!1,columnSortable:!1,columnContextMenu:null,columnSortMode:"click",headerVisible:!0,dataSource:null,deferRender:!0,scrollDelay:null,autoClean:!0,hoverMode:"row",selectionMode:"cells",selectionMarked:!0,valueType:"list"},f:{childModules:{}},h:{rangeStart:-1,rangeEnd:-1},n:{initEvents:function(){var e=this.DOMMap;this[0].on("keydown",function(e){e.keyCode}),e.table.unselect(!0).on("click",function(){})},initScrollEvent:function(){var n=this,i=n.DOMMap;i.viewBody.scrollTop(i.dataBody.scrollTop()),i.dataBody.on("scroll",function(){var e=this.scrollTop(),t=this.scrollLeft();i.viewBody.scrollTop(e),i.dataColumns.css("left",-t),n.emit("scroll",[e,t],!0)})},initChildModules:function(){var e=d.childModules;u=u||e.column,t=t||e.cell,n=n||e.row,i=i||e.mergedCells,r=r||e.container,o=o||e.selection,l=l||e.style,a=a||e.ViewBody,s=s||e.plugin},initColumnEvents:function(){var r=this,l=(r.opts,r.DOMMap);l.dataColumns.on("mouseenter","> ._column",function(e){var i=this.index(),o=r._columns[i],t={auto:!1};Std.each(["enter","leave","down","up","click","dblclick"],function(e,n){t[n]=function(e){if("down"===n){var t=l.dataColumns.plugin("resize");if(t&&0!==t.cursorCode)return;r.currentColumnIndex(i)}o.sortable()&&"down"===n||r._selection.columnEvents(e.name,o,e),o.triggerEvents(e.name,e),r.emit("columnEvent",[e.name,o,e],!0)}}),this.mouse(t,e)})},initRowEvents:function(){var o=this,t=o.opts,e=o.DOMMap;o._viewBody.initRowEvents(),e.dataBodyRows.on("mouseenter","> ._row",function(e){var n=this.data("row"),i={auto:!1,classStatus:"row"===t.hoverMode};Std.each(["enter","leave","down","up","click","dblclick"],function(e,t){i[t]=function(e){"down"===t&&Std.mold.or("INPUT TEXTAREA",e.target.nodeName)||o._selection.rowEvents(e.name,n,e),o.emit("rowEvent",[e.name,n,e],!0)}}),this.mouse(i,e)})},initCellEvents:function(){function i(e,n,i){var o={auto:!1,classStatus:"cell"===t.hoverMode};Std.each(["enter","leave","down","up","click","dblclick"],function(e,t){o[t]=function(e){"down"===t&&Std.mold.or("INPUT TEXTAREA",e.target.nodeName)||(n.triggerEvents(e.name,e),r._selection.cellEvents(e,e.name,n,i)),r.emit("cellEvent",[e.name,n,e],!0)}}),n[0].mouse(o,e)}var r=this,t=r.opts,e=r.DOMMap;e.dataBody.on("mouseenter",">._cells > ._cell",function(e){return i(e,this.data("cell"),null)}),e.dataBody.on("mouseenter",">._rows > ._row > ._cells > ._cell",function(e){var t=this.parent("._row").data("row"),n=this.index(),t=t.cells[n];return i(e,t,n)})},initDOMTree:function(){var e=this.opts,t=this.DOMMap={},e=e.defaultClass;t.table=newDom("table").append(t.tbody=newDom("tbody").append([t.header=newDom("tr",e+"_Header"),t.body=newDom("tr",e+"_Body")])).appendTo(this[0]),t.header.append([t.viewHeaderTD=newDom("td").append(t.viewHeader=newDiv(e+"_ViewHeader").append(t.viewColumns=newDiv("_columns"))),t.dataHeaderTD=newDom("td").append(t.dataHeader=newDiv(e+"_DataHeader").append(t.dataColumns=newDiv("_columns")))]),t.body.append([t.dataBodyTD=newDom("td").append(t.dataBody=newDiv(e+"_DataBody").append([newDiv("_placeHolder"),t.dataBodyRows=newDiv("_rows").append(t.dataBodyLines=newDiv("_lines"))]))]),this._viewBody.initDOMTree()},initDataSource:function(){var n=this,i=n.opts,e=n.dataSource=Std.dataSource(i.dataSource),t=!0;"data"===e.type()&&(e.data=n._rows),e.on("error",function(){!t&&0<n._container.length&&n.clearRows()}).on("message",function(e){"rows"===e.name&&(!t&&0<n._container.length&&n.clearRows(),isArray(e.value)&&n.appendRow(e.value),t=!1),n.emit("dataSourceMessage",e)}).call("rows").call("data",function(e,t){isObject(t.cellModel)&&n.cellModel(t.cellModel),isNumber(t.columnCount)&&n.columnCount(t.columnCount),isNumber(t.rowCount)&&n.rowCount(t.rowCount),isArray(i.mergedCells)&&n.mergeCell(i.mergedCells),isArray(t.columns)&&n.appendColumn(t.columns),isArray(t.rows)&&n.appendRow(t.rows)})}},g:{render:function(){var e=this,t=e.opts;e._style.update(),e._container.init(),e.initEvents(),e.initScrollEvent(),e.initColumnEvents(),e.initCellEvents(),e.initRowEvents(),e.call_opts({cellContextMenu:null,rowContextMenu:null,columnContextMenu:null},!0),t.dataSource&&e.initDataSource()},width:function(e){var t=this,n=t.boxSize,i=t.DOMMap,o=t._viewBody.width();e=(e=isNumber(e)?e:t.width())-n.width-n.extraWidth,i.table.width(e),i.dataBody.width(t._dataBodyWidth=e-o),t._viewBody.updateWidth(),t._selection.update(),t.updateColumnsWidth()},height:function(e){var t=this,n=t.opts,i=t.DOMMap,o=t.boxSize;e=(e=isNumber(e)?e:t.height())-o.height-o.extraHeight,i.table.height(e),n.headerVisible&&(e-=n.columnHeight),i.header.height(n.columnHeight),i.dataBody.height(e),t._viewBody.height(e),t._container.rangeHeight(e)},destroy:function(){var e=this;e._inputElem&&(e._inputElem.remove(),e._inputElem=null),e._style.destroy(),e._container.destroy()}},protected:{computeColumnsWidth:function(e){var t=this.opts;if(void 0===e){for(var n=0,i=0,o=t.columnCount;n<o;n++)this._columns[n].visible()&&(i+=this._columns[n].width());return i}},computeRowTop:function(e){var t=this._container;return isString(e)&&(e=t.itemName2Index(e)),t.computeItemTop(e)},computeColumnLeft:function(e){var t=this._columns;isString(e)&&(e=this._columnsMap[e]);for(var n=0,i=0;n<e;n++)t[n].visible()&&(i+=t[n].width());return i},createContainer:function(){var i=this,o=i.opts;return i._container=new r({items:i._rows,parent:i,monitor:i.DOMMap.dataBody,deferRender:o.deferRender,scrollDelay:o.scrollDelay,autoClean:o.autoClean,container:i.DOMMap.dataBodyRows,itemHeight:o.rowHeight,itemRender:function(e){return new n(e,i)},scroll:function(e){i.DOMMap.viewBody.scrollTop(e)},appear:function(e,t,n){t.update(n)},updateCurrentRange:function(e,t,n){i._rangeStart=e,i._rangeEnd=t,i._mergedCells.update(),(o.rowNumbers||o.rowCheckable||o.rowLabels||o.rowExtensible)&&(i.DOMMap.viewBodyRows.css("top",n),i.updateRangeRows(e,t))}}),i},updateColumnsWidth:function(e){for(var t=this,n=0,i=!1,o=t.columnCount();n<o;n++){var r=t._columns[n];if(isString(r.opts.width)){i=!0;break}}return!1!==e&&!0===i&&!0===t.rendered&&t._style.update(),t},updateColumnsClass:function(e){for(var t=this._columns,n=e||0,i=t.length;n<i;n++)t[n][0].className("_column _column"+n);return this},updateColumnsNameIndex:function(){var n=this;return Std.each(n._columns,function(e,t){t=t.name();"string"==typeof t&&(n._columnsNameIndex[t]=e)}),n},updateRangeRows:function(e,t){for(var n=this,i=n._container._items,o=n._viewBody._rows,r=n._selection._markedRows,l=n.opts.selectionMode,a=0,s=!1,d=0,c=0;a<=t-e;a++){var u,h=i[e+a],m=h.data,p=(p=o[a])||(o[a]={row:newDiv("_row").insertBefore(n.DOMMap.viewBodySpacing)}),m=("checked"===l&&(u=h.owner[0].hasClass("selected"),!0===m.checked?u||h.owner[0].addClass("selected"):u&&h.owner[0].removeClass("selected")),p.index=e+a,p.row.data("viewRow",p),n._viewBody.updateViewRow(p,h.owner),"height"in p?p.height:n.opts.rowHeight);r&&n._viewBody.updateRowMark(a)&&(p.marked&&(s=!0,c+=m),!1===s&&(d+=m))}if(o.length>t-e)for(a=o.length-1;t-e<a;a--)0<=a&&(o[a].row.remove(),o.remove(a));return r&&n.DOMMap.viewSelection.css({top:d-1,height:c+1}),n}},j:{indexOf:function(e,t){return this._container.indexOf(e,t)},column:function(e){return isString(e)?this._columnsMap[e]||null:this._columns[e]||null},row:function(e){e=this._container.items(e);return null!==e?e.data:null},cell:function(e,t,n){var i=this,e=i._container.items(e),o=null;if(null===e)return o;if(isNumber(t)&&!isArray(e.data.cells)){if(!(t<i.opts.columnCount))return o;t=i._columns[t].name()}else if(isString(t)&&isArray(e.data.cells)){if(!(t in i._columnsNameIndex))return o;t=i._columnsNameIndex[t]}return void 0===n?e.data.cells&&(o=e.data.cells[t]):(e.data.cells[t]=o=n,e.owner&&e.owner.updateCell(t,n,!1)),void 0===o?null:o},selectedRange:function(){return this._selection.selectedRange()},selectedRanges:function(){return this._selection.selectedRanges()},selectedCell:function(e){var t=this._selection.selectedCell();return null!==t&&!0===e?this.cell(t.rowIndex,t.colIndex):t},selectedCells:function(e){var t=this._selection.selectedCells();if(null!==t&&!0===e)for(var n=0,i=t.length;n<i;n++)t[n]=this.cell(t[n].rowIndex,t[n].colIndex);return t},selectedRow:function(e){var t=this._selection.selectedRow();return null!==t&&!0===e?this.row(t):t},selectedRows:function(e){var t=this._selection.selectedRows();if(null!==t&&!0===e)for(var n=0,i=t.length;n<i;n++)t[n]=this.row(t[n]);return t},checkedRows:function(e){for(var t=this._container._items,n=[],i=0,o=t.length;i<o;i++)t[i].data.checked&&(!0===e?n.push(i):n.push(t[i].data));return n},cellContextMenu:function(e){return this.opt("cellContextMenu",e,function(){this._plugin.initCellContextMenu()})},rowContextMenu:function(e){return this.opt("rowContextMenu",e,function(){this._plugin.initRowContextMenu()})},columnContextMenu:function(e){return this.opt("columnContextMenu",e,function(){this._plugin.initColumnContextMenu()})},stripeRows:function(e){return this.opt("stripeRows",e,function(){this.rendered&&this._container.update()})},selectionMarked:function(e){return this.opt("selectionMarked",e)},selectionMode:function(e){return this.opt("selectionMode",e,function(){this._selection._mode!==e&&this.emit("selectionModeChange",this._selection._mode=e)})},verticalLine:function(e){return this.opt("verticalLine",e,function(){this.rendered&&this._style.update()})},horizontalLine:function(e){return this.opt("horizontalLine",e,function(){this.rendered&&this._style.update()})},headerVisible:function(e){var t=this;return t.opt("headerVisible",e,function(){t.DOMMap.header.visible(e),t.rendered&&t.resize("height")})},cellEditable:function(e){return this.opt("cellEditable",e)},cellEditMode:function(e){return this.opt("cellEditMode",e)},cellCoordText:function(e){return this.opt("cellCoordText",e)},cellModel:function(e,t){var n=this;if(void 0===e)return n._cellModel;if(void 0!==t)n._cellModel[e]=t;else{if("string"==typeof e)return n._cellModel[e]||null;"object"==typeof e&&(Object.clear(n._cellModel),Std.extend(n._cellModel,e))}return n},mergeCell:function(e){return this._mergedCells.append(e),this},unmergeCell:function(e,t){var n=this._mergedCells;return isObject(e)&&"startRow"in e&&"startCol"in e&&(t=e.startCol,e=e.startRow),n.remove(e,t),this},lockCell:function(e,t){},columnSortable:function(e){return this.opt("columnSortable",e)},columnSortMode:function(e){return this.opt("columnSortMode",e)},columnResizable:function(e){return this.opt("columnResizable",e,function(){e&&this._plugin.initColumnResizePlugin()})},columnDroppable:function(e){return this.opt("columnDroppable",e,function(){e&&this._plugin.initColumnDropPlugin()})},columnVisible:function(e,t){e=this.column(e);return void 0===t?e.visible():(e.visible(t),this)},columnName2Index:function(e){var t=this._columnsNameIndex;return e in t?t[e]:-1},insertColumn:function(e,n){var i=this,t=i.opts,o=new u(e,i),r=i._columns;!isNumber(n)||-1===n||n>r.length?n=r.length:i._mergedCells.adjustRange("insertColumn",n),Std.each(i._columnsNameIndex,function(e,t){n<=t&&(i._columnsNameIndex[e]=t+1)});for(var l=0,a=i._container.length;l<a;l++){var s=i._container._items[l],d=s.owner,s=s.data.cells;s&&(s instanceof Array?s.insert(null,n):e.name&&(s[e.name]=null)),d&&d.insert(e.name,n)}return t.columnCount<=r.length&&t.columnCount++,e.name&&(i._columnsMap[e.name]=o,i._columnsNameIndex[e.name]=n),r.insert(o,n),o[0].insertTo(i.DOMMap.dataColumns,n),i.rendered&&(i._mergedCells.update(),i._selection.update(),i._container.update(),i._style.update()),i.updateColumnsClass()},appendColumn:function(e){function t(e){var t=new u(e,n);t[0].addClass("_column"+o.length).appendTo(n.DOMMap.dataColumns),e.name&&(n._columnsMap[e.name]=t,n._columnsNameIndex[e.name]=o.length),i.columnCount<=o.length&&i.columnCount++,o.push(t)}var n=this,i=n.opts,o=n._columns;if(isArray(e))for(var r=0,l=e.length;r<l;r++)t(e[r]);else isObject(e)&&t(e);return n.rendered&&n._container.update()&&n._style.update(),n},sortColumn:function(e,t){e=this.column(e);return e&&e.sortable()&&e.sort(t),this},moveColumn:function(e,t,n){var i=this,o=-1,r=-1,l=i._columns;if(e instanceof u?o=l.indexOf(e):isNumber(e)&&(e=l[o=e]),t instanceof u?r=l.indexOf(t):isNumber(t)&&(t=l[r=t]),o===r||e===t)return i;"after"===n?e[0].insertAfter(t[0]):e[0].insertBefore(t[0]),l.move(o,r=e[0].index());for(var a=0,s=i._container.length;a<s;a++){var d=i._container._items[a],c=d.owner,d=d.data.cells;c?c.moveCell(o,r):d&&d instanceof Array&&d.move(o,r)}return i.updateColumnsNameIndex(),i._mergedCells.adjustRange("move",o,r),i.rendered&&(i._container.update(),i._style.update(),i._selection.update(),i._mergedCells.update()),i.updateColumnsClass()},removeColumn:function(a){function e(e){var t=null,n=null;isString(e)?n=s._columnsNameIndex[t=e]:isNumber(e)&&(t=s._columns[n=e].name()),isString(t)&&(delete s._columnsMap[t],delete s._columnsNameIndex[t]),isNumber(n)&&(s._columns[n].destroy(),s._columns.remove(n));for(var i=0,o=s._container.length;i<o;i++){var r=s._container._items[i],l=r.owner,r=r.data.cells;l?l.removeCell(a):r&&(r instanceof Array?r.remove(n):delete r[t])}d.columnCount--,s._mergedCells.adjustRange("removeColumn",n)}var s=this,d=s.opts;if(isArray(a))for(var t=0,n=a.length;t<n;t++)e(a[t]);else e(a);return s.updateColumnsClass(),s.updateColumnsNameIndex(),s.updateColumnsWidth(!1),s.rendered&&(s._selection.clear(),s._mergedCells.update(),s._container.update(),s._style.update()),s.emit("removeColumn",a)},columnCount:function(e){var t=this._columns.length;if(void 0===e)return t;if(t<e){for(var n=t,i=[];n<e;n++)i.push({text:Std.convert.ntol(n)});this.appendColumn(i)}else if(e<t)for(n=t;e<n;n--)this.removeColumn(n-1);return this},rowName2Index:function(e){return this._container.itemName2Index(e)},rowHeight:function(e){var t=this;return t.opt("rowHeight",e,function(){t._container.itemHeight(e),t.rendered&&t._style.update()})},rowResizable:function(e){return this.opt("rowResizable",e,function(){e&&this._plugin.initRowResizePlugin()})},rowCheckable:function(e){var t=this,n=t.opts,i=t.DOMMap,o=t._viewColumns;return t.opt("rowCheckable",e,function(){t._viewBody.initCheckboxEvents(),e&&!o.checkbox?i.viewColumns.append(o.checkbox=newDiv("_column").width(n.rowCheckBoxWidth-2).append(i.checkbox=newDiv("StdUI_Grid_CheckBox"))):!e&&o.checkbox&&(o.checkbox.remove(),i.checkbox.remove(),delete i.checkbox,delete o.checkbox),t.rendered&&t._style.update()&&t.resize("width")&&t._container.update()})},rowNumbers:function(e){var t=this,n=t.opts,i=t.DOMMap,o=t._viewColumns;return t.opt("rowNumbers",e,function(){e&&!o.number?i.viewColumns.prepend(o.number=newDiv("_column").width(n.rowNumberWidth-2)):!e&&o.number&&(o.number.remove(),delete i.number,delete o.number),t.rendered&&t._style.update()&&t.resize("width")&&t._container.update()})},rowLabels:function(e){var t=this,n=t.opts,i=t.DOMMap,o=t._viewColumns;return t.opt("rowLabels",e,function(){e&&!o.label?i.viewColumns.append(o.label=newDiv("_column").width(n.rowLabelWidth-2)):!e&&o.label&&(o.label.remove(),delete i.label,delete o.label),t.rendered&&t._style.update()&&t.resize("width")&&t._container.update()})},rowExtensible:function(e){var t=this,n=t.opts,i=t.DOMMap,o=t._viewColumns;return t.opt("rowExtensible",e,function(){t._viewBody.initExpanderEvents(),e&&!o.expander?i.viewColumns.append(o.expander=newDiv("_column").width(n.rowExpanderWidth-2).append(i.expander=newDiv("_expander"))):!e&&o.expander&&(o.expander.remove(),i.expander.remove(),delete i.expander,delete o.expander),t.rendered&&t._style.update()&&t.resize("width")&&t._container.update()})},rowCount:function(e){var t=this._container.length;if(void 0===e)return t;if(t<e){for(var n=0,i=[];n<e-t;n++)i[n]={};this._container.append(i)}else if(e<t){for(var o=[];e<t;t--)o.push(t-1);this._container.remove(o)}return this},insertRow:function(e,t){var n=this;return isNumber(t)&&0<=t&&t<n._container.length&&n._mergedCells.adjustRange("insertRow",t),n._container.insert(e,t),n.rendered&&(n._mergedCells.update(),n._selection.update()),n},appendRow:function(e){return this._container.append(e),this},removeRow:function(e){var t=this;if(isNumber(e))e<t._container.length&&t._mergedCells.adjustRange("removeRow",e);else if(isArray(e)){e.sort(function(e,t){return t-e});for(var n=0,i=e.length;n<i;n++)e[n]<t._container.length&&t._mergedCells.adjustRange("removeRow",e[n])}return t._container.remove(e),t.rendered&&(t._selection.clear(),t._mergedCells.update()),t},currentColumnIndex:function(e){var t=this._currentIndex;return void 0===e?t.column:(t.column=e,this)},currentRowIndex:function(e){var t=this._currentIndex;return void 0===e?t.row:(t.row=e,this)},currentCellIndex:function(e){var t=this._currentIndex;return void 0===e?t.cell:(t.cell=e,this)},scrollTop:function(e){var t=this.DOMMap.dataBody;return void 0===e?t.scrollTop():(t.scrollTop(e),this)},scrollLeft:function(e){var t=this.DOMMap.dataBody;return void 0===e?t.scrollLeft():(t.scrollLeft(e),this)},gotoRow:function(e,t){e=this.computeRowTop(e);return isNumber(t)&&(e+=t),this.scrollTop(e),this},selectColumn:function(e){return-1!==(e=isString(e)?this.columnName2Index(e):e)&&this._selection.selectColumn(e),this},selectRow:function(e){return-1!==(e=isString(e)?this.rowName2Index(e):e)&&this._selection.selectRow(e),this},selectCell:function(e,t){return isString(e)&&(e=this.rowName2Index(e)),isString(t)&&(t=this.columnName2Index(t)),-1!==e&&-1!==t&&this._selection.selectCell(e,t),this},selectRange:function(e,t,n,i){var o=this;return isString(e)&&(e=o.rowName2Index(e)),isString(t)&&(t=o.columnName2Index(t)),isString(n)&&(n=o.rowName2Index(n)),isString(i)&&(i=o.columnName2Index(i)),-1!==e&&-1!==t&&-1!==n&&-1!==i&&o._selection.selectRange(e,t,n,i),o},clearRows:function(){var e=this;return e._selection.clear(),e._container.clear(),e._mergedCells.clear(),e._viewBody.clear(),e.rowCount(0),e.emit("clearRows")},clear:function(){return this.clearRows(),this.columnCount(0),this.emit("clear")},value:function(e){var t,n=this.opts,i=n.valueType,o=n.value;return void 0===e?(t=null)===i?o:("list"===i?t=this._container._items:"map"===i&&(t=this._container._itemsMap),Std.each(t,function(e,t){return t.data.cells},!0)):(null===i&&(n.value=e),this)},refresh:function(){var e=this;return e.updateColumnsClass(),e.updateColumnsNameIndex(),e.updateColumnsWidth(!1),e.rendered&&(e._selection.clear(),e._mergedCells.update(),e._container.update(),e._style.update()),e}},k:function(e,t){e.initChildModules(),e.addClass(e._identifier=t.defaultClass+Date.now()),e._viewBody=new a(e),e._style=new l(e),e._selection=new o(t.selectionMode,e,t),e._mergedCells=new i(e),e._plugin=new s(e),e._rows=[],e._columns=[],e._columnsMap={},e._columnsNameIndex={},e._viewColumns={},e._cellModel={},e._currentIndex={cell:null,row:null,column:null},e.initDOMTree(),e.createContainer(),t.rows&&e.appendRow(t.rows),t.columns&&e.appendColumn(t.columns),t.mergedCells&&e.mergeCell(t.mergedCells),e.call_opts({headerVisible:!0,cellModel:null,rowNumbers:!1,rowCheckable:!1,rowLabels:!1,rowResizable:!1,rowExtensible:!1,columnResizable:!1,columnDroppable:!1,columnSortable:!1,columnCount:0,rowCount:0},!0)},m:{rule:{children:"appendRow"},html:{nodeName:["DIV"],create:function(e){function i(e){Std.each(e,function(e,t){"UL"===t.nodeName()&&Std.each(t.children(),function(e,t){n.push(Std.extend({text:t.trimHTML(),name:t.attr("std-name")},Std.options.get(t),3))})})}function o(e){Std.each(e,function(e,t){"UL"===t.nodeName()&&(t=t,r.push(Std.extend({cells:Std.each(t.children(),function(e,t){return t.html().trim()},!0)},Std.options.get(t))))})}var n=[],r=[];e.children(function(e,t){var n=t.attr("std-type"),t=t.children();"header"===n?i(t):"body"===n&&o(t)}),this.appendColumn(n),this.appendRow(r)}}}})}(),Std.ui("Grid").childModules.column=Std.module({e:{name:null,parent:null,visible:!0,sortable:!0,droppable:!0,resizable:!0,editable:!0,className:"",text:"column",textAlign:"left",cellModel:null,cellFormatter:null},protected:{destroy:function(){return this[0].remove(),this},width:function(e){var t=this.opts,n=this.grid;return void 0===e?t.visible?null==t.width?n.opts.columnWidth:isString(t.width)?Math.floor(n._dataBodyWidth*(Std.convert.percent(t.width)/100)):t.width:0:(t.width=e,n.rendered&&n._style.update(),this)},triggerEvents:function(e,t){var n=this,i=n.grid,o=n.sortable(),i=i.columnSortMode().split(" "),r="asc"===n._sortType?"desc":"asc";"click"===e?o&&i.has("click")&&n.sort(r):"dblclick"===e&&o&&i.has("dblclick")&&n.sort(r)}},j:{name:function(){return this.opt("name")},index:function(){return this.grid._columns.indexOf(this)},editable:function(e){return this.opt("editable",e)},resizable:function(e){return void 0===e?this.grid.columnResizable()&&this.opts.resizable:(this.opts.resizable=e,this)},droppable:function(e){return void 0===e?this.grid.columnDroppable()&&this.opts.droppable:(this.opts.droppable=e,this)},sortable:function(e){return void 0===e?this.grid.columnSortable()&&this.opts.sortable:(this.opts.sortable=e,this)},visible:function(e){var t=this.grid;return this.opt("visible",e,function(){this[0].visible(e),t.rendered&&(t.resize("width"),t._selection.clear(),t._mergedCells.update(),t._style.update())})},textAlign:function(e){return this.opt("textAlign",e,function(){})},text:function(e){return this.opt("text",e,function(){this.DOMMap.content.html(e)})},cellCSS:function(e){return this.opt("cellCSS",e,function(){this.grid.rendered&&this.grid._style.update()})},css:function(e,t,n){e=this[0].css(e,t,n);return e=e===this[0]?this:e},cellFormatter:function(e){var t=this.opts;return void 0===e?isFunction(t.cellFormatter)?t.cellFormatter:null:(t.cellFormatter=e,this)},cellModel:function(e){var t=this.opts,n=this.grid;return void 0===e?"string"==typeof t.cellModel?n._cellModel[t.cellModel]||null:t.cellModel||null:(t.cellModel=e,this)},sort:function(e){var t=this,n=t.grid,i=t.name(),o=t.index();return n.DOMMap.columnArrow&&n.DOMMap.columnArrow.remove(),t[0].append(n.DOMMap.columnArrow=newDiv("_arrow _"+(e=void 0===e?"asc":e))),n._container.sort(t._sortType=e,function(e){if(!e)return null;e=e.cells;return e instanceof Array?e[o]:"object"==typeof e?e[i]:void 0}),n.rendered&&n._selection.clear(),t}},k:function(e,t){var n=this,e=n.init_opts(e);n[0]=newDiv("_column"),n.grid=t,n.DOMMap={content:newDiv("_content").appendTo(n[0])},e.css&&n.css(e.css),e.className&&n[0].className("_column "+e.className),e.visible||n.visible(!1),e.text&&n.DOMMap.content.html(e.text)}}),function(){var n=Std.ui("Grid").childModules.cell=Std.module({f:{ui:function(e,t){var n=this,i=e.model;return n.widget||(n.widget=Std.ui(i.ui||"widget",i),n.widget.parent(n).renderTo(n[1]),isFunction(e.create)&&e.create.call(n,n,t,n.widget)),e.forceWidgetWidth&&n.widget.width(n[1].width()),e.forceWidgetHeight&&n.widget.height(n[1].height()),n.widget},template:function(e,t){var n=this;return isString(t)&&(t={text:t}),n.template||(n.template=Std.template(e.model)),n.template&&isObject(t)?(e=n.template.build(t),n[1].html(e),e):null}},i:{coordText:function(){var e=this,t=e.rowIndex();return new Std.template(e.grid.cellCoordText()).build({row:t,col:e.index,line:t+1,columnText:e.grid.column(e.index).text()})},height:function(e){var t=this,n=t.grid;return void 0===e?t[0].height():(t[0].height(e-1),t[1].height(e-1-2*n.opts.cellPadding),t[1].lineHeight(e-1-2*n.opts.cellPadding),t)},clear:function(){var e=this;return e.widget&&(e.widget.destroy(),delete e.widget),e[1].clear(),e},destroy:function(){var e=this;return e.widget&&(e.widget.destroy(),delete e.widget),null!=e._timer&&(clearTimeout(e._timer),e._timer=null),e[0].remove(),e},updateByModel:function(e,t){return e.type in n&&n[e.type].call(this,e,t),isFunction(e.update)&&e.update.call(this,this,t),this},updateByOption:function(e){var t=this;return"css"in e&&t.css(e.css),"on"in e&&t[0].on(e.on),"html"in e?t.html(e.html):"text"in e&&t.text(e.text),t},editByText:function(t){var n=this,i=!1,o=null,e=n.column().cellFormatter(),r="",l=(e?isNumber(n.data)||isString(n.data)?r=n.data:isObject(n.data)&&("text"in n.data?r=n.data.text:"html"in n.data&&(r=n.data.html)):r=n[1].text(),n.grid._inputElem=n[1].editText({type:"cover",text:r,minWidth:n[0].outerWidth(),minHeight:n[0].outerHeight(),changeText:!1,textSelected:!1,className:"StdUI_Grid_DOMEditText",apply:function(e){o&&(o.remove(),o=null),isObject(n.data)?"text"in n.data?n.text(n.data.text=e):"html"in n.data&&n.html(n.data.html=e):(n.html(e),n.updateData(e)),isFunction(t)&&t.call(n,e),i=!0,n.status="",n.grid.emit("cellEdit",[n,e,r],!0),n.grid._inputElem=null}}));n.grid.DOMMap.dataBody.once("scroll",function(){!1===i&&((o=newDiv("StdUI_Grid_CellCoord").appendTo("body")).html(n.coordText()),o.css({top:l.css("top")-o.outerHeight()-1,left:l.css("left"),zIndex:++Std.ui.status.zIndex}))})},editByModel:function(e){var t=this,n=Std.dom(document),i=function(e){t[1].contains(e.target)||(t.widget&&t.widget[0].fireEvent("blur"),t._timer=null,t.status="",t.clear().update(),n.off("mousedown",i))};return n.on("mousedown",i),t.clear().updateByModel(e,t.data)},triggerEvents:function(e,t){var n=this,i=n.grid,o=n.model(),r="default",l=i.cellEditable(),i=i.cellEditMode().split(" ");o&&o.mode&&(r=o.mode),"mouseenter"===e?"hover"===r&&n.clear().updateByModel(o,n.data):"mouseleave"===e?"hover"===r&&n.clear().update():"click"===e?l&&i.has("click")&&n.edit():"dblclick"===e&&l&&i.has("dblclick")&&n.edit()}},j:{column:function(){return this.grid._columns[this.index]},model:function(){return this.column().cellModel()},formatter:function(){return this.column().cellFormatter()},rowIndex:function(){return this.merged?this.range.startRow:this.row.index()},css:function(e,t,n){e=this[0].css(e,t,n);return e=e===this[0]?this:e},visible:function(e){var t=this;return void 0===e?t._visible:(e!==t._visible&&t[0].css("visibility",!1===(t._visible=e)?"hidden":""),t)},text:function(e){var t=this,n=t.formatter();return void 0===e?t[1].text():(t.widget&&(t.widget.destroy(),delete t.widget),"function"==typeof n&&(e=n.call(t,e)),t[1].text(e),t)},html:function(e){var t=this,n=t.formatter();return void 0===e?t[1].html():(t.widget&&(t.widget.destroy(),delete t.widget),"function"==typeof n&&(e=n.call(t,e)),t[1].html(e),t)},edit:function(){var t=this,e=t.data,n=t.column(),i=n.cellModel();return"edit"===t.status||isObject(e)&&e.locked||!n.editable()||(i&&"edit"===i.mode&&i.type&&!1!==i.editable?t.editByModel(i):i?i.type||!1===i.editable||t.editByText(function(e){isFunction(i.update)&&i.update.call(t,t,e)}):t.editByText(),t.status="edit"),t},updateData:function(e){var t=this,n=null,n=(t.merged?t.grid.row(t.range.startRow):t.row.data).cells;return isArray(n)?n[t.index]=e:t.name&&(n[t.name]=e),t.data=e,t},update:function(e,t,n){var i=this,o=i.column().cellModel();if(void 0===e)e=i.data;else{if(e===i.data&&!0!==n)return i;!1===t?i.data=e:i.updateData(e)}return!o||o.mode&&"default"!==o.mode?isNumber(e)||isString(e)?i.html(e):isObject(e)&&i.updateByOption(e):i.updateByModel(o,e),i}},k:function(e,t,n,i){var o=this;"object"==typeof i?(o.grid=n,o.range=i,o.merged=!0):(o.row=n,o.grid=n.grid),o.name=t,o.index=e,o[0]=newDiv("_cell _cell"+e).append(o[1]=newDiv("_content")),!0===o.merged&&o[0].data("cell",o)}})}(),function(){var o=Std.ui("Grid").childModules.cell;Std.ui("Grid").childModules.row=Std.module({i:{createContentWidget:function(e){var t={parent:this,appendTo:this[0],height:this.contentHeight(),tabIndex:null,defaultClass:"_content"};return isObject(e)?t=Std.extend(e,t):isString(e)&&(t.html=e),this.DOMMap.content=Std.ui("widget",t)},append:function(e){var t=this,n=t.length,n=t.cells[n]=new o(n,e||null,t);return t.DOMMap.cells.append(n[0]),"height"in t.data&&n.height(t.data.height),t.length++,t},insert:function(e,t){if(0===this.length)return this;var n=this,e=new o(t,e||null,n);e[0].insertBefore(n.cells[t][0]),n.cells.insert(e,t),"height"in n.data&&e.height(n.data.height),n.length++;for(var i=t;i<n.length;i++)n.cells[i].index!==i&&n.cells[i][0].className("_cell _cell"+(n.cells[i].index=i));return n},detach:function(){return this[0].detach(),this},destroy:function(){for(var e=this,t=e.cells,n=0,i=t.length;n<i;n++)t[n].destroy();return e.DOMMap.content&&e.DOMMap.content.destroy(),e[0].remove(),e},contentHeight:function(e){var t=this,n=t.data,i=t.grid;return void 0===e?void 0!==n.contentHeight?n.contentHeight:i.opts.rowContentHeight:(n.contentHeight=e,t.DOMMap.content&&t.DOMMap.content.height(e),t)},height:function(e){var t=this,n=t.data,i=t.grid;if(void 0===e)return void 0!==n.height?n.height:i.opts.rowHeight;if(0<t.length)for(var o=0;o<t.length;o++)t.cells[o].height(e-1);return t.DOMMap.cells.css("lineHeight",e-1-2*i.opts.cellPadding).height((n.height=e)-1),t}},j:{length:0,index:function(){return this.grid.indexOf(this.data)},label:function(e){var t=this.data;return void 0===e?t.label||"":(t.label=e,this)},checked:function(e){var t=this.data;return void 0===e?!!t.checked:(t.checked=e,this)},expanded:function(e){var t=this.data;return void 0===e?!!t.expanded:(t.expanded=e,this)},selected:function(e){var t=this.selected;return void 0===e?!!t.selected:(t.selected=e,this)},moveCell:function(e,t){var n=this,i=n.data,i=(i.cells instanceof Array&&i.cells.move(e,t),n.cells[e]),o=n.cells[t];if(e!==t&&i&&o){e<t?i[0].insertAfter(o[0]):i[0].insertBefore(o[0]),n.cells.move(e,t);for(var r=0;r<n.length;r++)n.cells[r].index!==r&&n.cells[r][0].className("_cell _cell"+(n.cells[r].index=r))}return n},removeCell:function(e){var t=this,n=t.grid,i=t.data,o=i.cells instanceof Array;isString(e)&&(o||delete i.cells[e],e=n._columnsNameIndex[e]),o&&i.cells.remove(e),e<t.length&&(t.cells[e].destroy(),t.cells.remove(e),t.length--);for(var r=e;r<t.length;r++)t.cells[r].index!==r&&t.cells[r][0].className("_cell _cell"+(t.cells[r].index=r));return t},updateStripeClass:function(e){e=e%2==0?"_row":"_row _odd";return e!==this.className&&this[0].className(this.className=e),this},updateCell:function(e,t,n){var i=this.grid;return isString(e)&&(e=i._columnsNameIndex[e]),this.cells[e]&&this.cells[e].update(t,n),this},updateCells:function(n,i){var o=this;if(isArray(n))for(var e=0;e<o.length;e++)void 0===n[e]&&(n[e]=null),o.cells[e].update(n[e],!1,i);else Std.each(o.grid._columnsNameIndex,function(e,t){void 0===n[e]&&(n[e]=null),o.cells[t].update(n[e],!1,i)});return o},updateContent:function(e,t){var n=this,i=n.grid,o=n.data,r=n.DOMMap,l=n.height();return o.expanded?(r.content?r.content.show():n.createContentWidget(e).render(),l+=n.contentHeight()):!o.expanded&&r.content&&r.content.hide(),void 0!==t&&r.content&&(l===i.opts.rowHeight?i._container.unmarkItemHeight(t):i._container.markItemHeight(t,l)),n},update:function(e,t){var n=this,i=n.grid,o=n.data,r=i.opts.columnCount;if(void 0!==e&&i.opts.stripeRows&&n.updateStripeClass(e),n.length<r)for(var l=n.length,a=r;l<a;l++)n.append(i._columns[l].name());else if(r<n.length)for(l=n.length;r<l;l--)n.cells[l-1].destroy(),n.cells.remove(l-1),n.length--;return i.opts.rowExtensible&&!1!==o.extensible&&n.updateContent(o.content,e),n.updateCells(o.cells,t),n}},k:function(e,t){var n=this,i=n.DOMMap={};n[0]=newDiv(n.className="_row").data("row",n).append(i.cells=newDiv("_cells")),n.data=e,n.grid=t,n.cells=[],"name"in e&&(n.name=e.name),"height"in e&&n.height(e.height),e.cells||(e.cells=[])}})}(),function(){var d=Std.ui("Grid").childModules.cell;Std.ui("Grid").childModules.mergedCells=Std.module({i:{parseCellRange:function(e){var t={};return 2===(e=e.split("-")).length?(2===(e[0]=e[0].split(":")).length&&(t.startRow=~~e[0][0],t.startCol=~~e[0][1]),2===(e[1]=e[1].split(":")).length&&(t.endRow=~~e[1][0],t.endCol=~~e[1][1]),t):null}},j:{length:0,update:function(){for(var e=this,t=e.grid,n=t._rangeStart,i=t._rangeEnd,o=e.length-1;0<=o;o--){var r=e._cells[o],l=r.range;t._selection.rangeOverlap(l.startRow,l.endRow,n,i)&&e.updateCell(r)}return e},updateCell:function(e){var t=this.grid,n=e.range,i=t.DOMMap,o=t._selection.computeRangeSize("cells",n);i.dataBodyCells||(i.dataBodyCells=newDiv("_cells").appendTo(i.dataBody)),e.cell||(e.cell=new d(n.startCol,t._columns[n.startCol].name(),t,n),i.dataBodyCells.append(e.cell[0]));for(var r=n.startRow;r<=n.endRow;r++){var l=t._container._items[r].owner;if(l)for(var a=n.startCol;a<=n.endCol;a++){var s=l.cells[a];s&&s.visible(!1)}}t.opts.horizontalLine||(o.height+=1),e.cell[0].css({top:o.top,left:o.left,width:o.width-1}),e.cell.height(o.height),e.cell.update(t.cell(n.startRow,n.startCol),!1)},adjustRange:function(e,t,n){for(var i=this,o=i.grid.columnCount(),r=i._cells.length-1;0<=r;r--){var l=i._cells[r].range,a=l.startCol,s=l.startRow,d=l.endCol,c=l.endRow;"removeColumn"===e?t<a?(a--,d--):t<=d&&d--:"removeRow"===e?t<s?(s--,c--):t<=c&&c--:"insertColumn"===e?t<a?(a++,d++):t<=d&&d++:"insertRow"===e?t<s?(s++,c++):t<=c&&c++:"move"===e&&(t<a&&a<=n?(a--,d--):a<t&&t<d&&n<a?a++:a<t&&n<a?(a++,d++):t===a&&(d=n+(d-a),a=n)),(d=o<=d?o-1:d)-(a=a<0?0:a)<0||c-s<0||d-a<=0&&c-s<=0?i.remove(i._cells[r]):(i.visibleCells(s,c),l.startCol=a,l.startRow=s,l.endCol=d,l.endRow=c)}return i},append:function(e){function t(e){isString(e)&&(e=d.parseCellRange(e)),isObject(e)&&n(e,e.startRow,e.endRow,e.startCol,e.endCol)}var d=this,c=d.grid,n=function(e,t,n,i,o){var r=(n-t+1)*(o-i+1);if(!(r<=0)){for(var l=d.length-1;0<=l;l--){var a=d._cells[l],s=a.range;c._selection.rangeOverlap(s.startRow,s.endRow,t,n)&&c._selection.rangeOverlap(s.startCol,s.endCol,i,o)&&d.removeByItem(a)}d._cells.push({range:e}),d.length++}};if(isArray(e))for(var i=0,o=e.length;i<o;i++)t(e[i]);else t(e);d.grid.rendered&&d.grid._container.updateCurrentRange()},visibleCells:function(e,t){for(var n=this.grid._container._items,i=e,o=n.length;i<=t&&!(o<=i);i++){var r=n[i].owner;if(r&&r.cells)for(var l=0;l<=r.cells.length;l++){var a=r.cells[l];a&&a.visible(!0)}}},unmerge:function(e,t,n,i,o){for(var r=!1,l=this.grid._container._items,a=t,s=l.length;a<=n&&!(s<=a);a++){var d=l[a].owner;if(d&&d.cells)for(var c=i;c<=o;c++){var u=d.cells[c];u&&(u.visible(!0),!1===r&&u.update(e,r=!0,!0))}}},removeByItem:function(e){var t=null,n=e.range;e.cell&&(t=e.cell.data,e.cell.destroy()),this._cells.remove(this._cells.indexOf(e)),this.length--,this.unmerge(t,n.startRow,n.endRow,n.startCol,n.endCol)},removeByIndex:function(e,t){for(var n=this,i=0,o=n.length;i<o;i++){var r=n._cells[i],l=r.range,a=l.startRow,s=l.endRow,d=l.startCol,l=l.endCol;if(a<=e&&e<=s&&d<=t&&t<=l){var c=null;r.cell&&(c=r.cell.data,r.cell.destroy()),n._cells.remove(i),n.length--,n.unmerge(c,a,s,d,l);break}}},remove:function(e,t){if(isObject(e))return this.removeByItem(e);isString(e)&&(t=(e=e.split(":"))[1],e=e[0]),this.removeByIndex(e,t)},clear:function(){for(var e=this._cells,t=0,n=this.length;t<n;t++){var i=e[t];i.cell&&(data=i.cell.data,i.cell.destroy())}return e.clear(),this.length=0,this}},k:function(e){this.grid=e,this._cells=[]}})}(),Std.ui("Grid").childModules.selection=Std.module({i:{rangeOverlap:function(e,t,n,i){return(n<=e&&e<=i||n<=t&&t<=i||e<=n&&i<=t)&&[n-e,i-t]},formatRange:function(e){var t={};return t.startRow=e.startRow,t.endRow="endRow"in e?e.endRow:t.startRow,"startCol"in e?(t.startCol=e.startCol,t.endCol="endCol"in e?e.endCol:t.startCol):(t.startCol=0,t.endCol=this.grid.columnCount()-1),t},createSelection:function(e,t,n){var i=this.grid,o={dom:newDiv("_selection").append(newDiv("_block")).appendTo(i.DOMMap.dataBody),type:e,range:t,forceType:n};return o.dom.data("selection",o),this._selections.push(o),this.updateSelection(o,null,n),"cell"!==e&&"cells"!==e||(n=i._container._items[t.startRow]).owner&&n.owner.cells[t.startCol]&&this.updateCurrentCell(t.startRow,t.startCol),o},startSelectRow:function(e,t){var n=this,i=n.createSelection("rows",{startRow:t,endRow:t});return this.startSelectRange(e[0],i,">._rows >._row",function(e){n.updateSelection(i,{startRow:t,endRow:e.data("row").index()})})},startSelectCell:function(e,i,o){var r=this,l=r.createSelection("cells",isObject(i)?Std.clone(i):{startRow:i,endRow:i,startCol:o,endCol:o});return this.startSelectRange(e[0],l,[">._rows > ._row > ._cells > ._cell",">._cells > ._cell"],function(e){var t=e.data("cell"),n={},n=isObject(i)?{startRow:i.startRow,startCol:i.startCol}:{startRow:i,startCol:o};t?(n.endRow=t.range.endRow,n.endCol=t.range.endCol):(n.endRow=e.parent("._row").data("row").index(),n.endCol=e.index()),r.updateSelection(l,n)})},startSelectColumn:function(e,i){var o=this,r=o.grid,l=e[0],a=o.selectColumn(i);return null===a||(o._tempCaller=function(e,t){var n;"mouseenter"===e&&(n=(n=(e=r.DOMMap.dataColumns).context(t.target,"._column"))||e.context(t.target,"> ._row > ._cells > ._cell"))&&l.not(n)&&o.updateSelection(a,{startCol:i,endCol:(l=Std.dom(n)).index()},"column")},Std.dom(document).once("mouseup",function(){o._tempCaller=null})),o},startSelectRange:function(n,e,o,i){var r=this,l=r.grid.DOMMap.dataBody;return r._tempCaller=function(e,t){"mouseenter"===e&&(e=function(e){var t=null;if(isString(o))t=l.context(e.target,o);else if(isArray(o))for(var n=0,i=o.length;n<i&&!(t=l.context(e.target,o[n]));n++);return t}(t))&&n.not(e)&&i.call(r,n=Std.dom(e))},Std.dom(document).once("mouseup",function(){r._tempCaller=null}),r},cellEvents:function(e,t,n,i){var o=this,r=n.row,l=n.merged?n.range:r.index(),a=isNumber(l)?l:l.startRow,s=isNumber(i)?i:l.startCol;"mousedown"===t&&(3===e.which?o.contains(a,s)||"cell"!==o._mode&&"cells"!==o._mode||(e.ctrlKey||o.clear(),o.selectCell(l,i)):"cell"===o._mode?o.clear().selectCell(l,i):"cells"===o._mode&&(e.ctrlKey||o.clear(),o.startSelectCell(n,l,i)),o.grid.currentRowIndex(a),o.grid.currentCellIndex(s),e.preventDefault()),o._tempCaller&&o._tempCaller(t,e,r,n,i)},rowEvents:function(e,t,n){var i,o=this;"mousedown"===e&&(i=t.index(),3===n.which?o.contains(i)||"row"!==o._mode&&"rows"!==o._mode||(n.ctrlKey||o.clear(),o.selectRow(t.index())):"row"===o._mode?o.clear().selectRow(i):("rows"===o._mode||n.viewRow&&"checked"!==o._mode&&"cell"!==o._mode)&&(n.ctrlKey||o.clear(),o.startSelectRow(t,i)),o.grid.currentRowIndex(i),n.preventDefault()),o._tempCaller&&o._tempCaller(e,n,t)},columnEvents:function(e,t,n){var i,o=this;"mousedown"===e&&(i=t.index(),"cells"===o._mode&&(n.ctrlKey||o.clear(),o.startSelectColumn(t,i)),n.preventDefault()),o._tempCaller&&o._tempCaller(e,n)},computeRangeSize:function(e,t){var n=this.grid,i=n._container.items("endRow"in t?t.endRow:t.startRow),o=n.computeRowTop(t.startRow),r=0,l=0,a=0;return"endRow"in t&&(a=n.computeRowTop(t.endRow)-o),l="startCol"in t?(r=n.computeColumnLeft(t.startCol),"endCol"in t?n.computeColumnLeft(t.endCol)-r+n._columns[t.endCol].width():n.computeColumnLeft(t.startCol)-r+n._columns[t.startCol].width()):n.computeColumnLeft(n._columns.length-1)+n._columns[n._columns.length-1].width(),{left:r,top:o,width:l,height:a+(i.owner?i.owner.height():n.opts.rowHeight)}},markColumn:function(){var e=this.grid,t=this._selections[0].range,n=0,i=0;"startCol"in t?"endCol"in t?(n=t.startCol,i=t.endCol):n=i=t.startCol:i=e.columnCount()-1;for(var o=0,r=e.columnCount();o<r;o++){var l=e._columns[o];n<=o&&o<=i?l[0].addClass("selected"):l[0].removeClass("selected")}return this._columnMarked=!0,this}},j:{selectedRange:function(){var e=this._selections.last();return e?this.formatRange(e.range):null},selectedRanges:function(){for(var e=[],t=this._selections,n=0,i=t.length;n<i;n++)e.push(this.formatRange(t[n].range));return e},selectedCell:function(){var e=this.selectedRange();return null===e?null:{rowIndex:e.startRow,colIndex:e.startCol}},selectedCells:function(){for(var e=[],t=this.selectedRanges(),n=0,i=t.length;n<i;n++)for(var o=t[n],r=o.startRow;r<=o.endRow;r++)for(var l=o.startCol;l<=o.endCol;l++)e.push(r+":"+l);for(1<i&&e.unique(),n=0,i=e.length;n<i;n++){var a=e[n].split(":");e[n]={rowIndex:~~a[0],colIndex:~~a[1]}}return e},selectedRow:function(){for(var e=this.grid.columnCount(),t=this._selections,n=0,i=t.length;n<i;n++){var o=t[n],r=o.range,o=o.type;if("row"===o||"rows"===o||"cells"===o&&0===r.startCol&&r.endCol===e-1)return r.startRow}return null},selectedRows:function(){for(var e=this.grid.columnCount(),t=[],n=this._selections,i=0,o=n.length;i<o;i++){var r=n[i],l=r.type,a=r.range;if("row"===l||"rows"===l||"cells"===l&&0===a.startCol&&a.endCol===e-1)if("endRow"in a)for(var s=a.startRow;s<=a.endRow;s++)t.push(s);else t.push(a.startRow)}return 1<o&&t.unique(),t},selectColumn:function(e){return this.grid.rowCount()<=0?null:this.createSelection("cells",{startRow:0,endRow:this.grid.rowCount()-1,startCol:e,endCol:e},"column")},selectRow:function(e){this.createSelection("row",{startRow:e});return this},selectCell:function(e,t){this.createSelection("cell",isObject(e)?e:{startRow:e,startCol:t});return this},contains:function(e,t){for(var n=this._selections,i=0,o=n.length;i<o;i++){var r=n[i].range,l=n[i].type,a=!1,s=!1;if(a="startRow"in r?"endRow"in r?e>=r.startRow&&e<=r.endRow:e===r.startRow:a){if(void 0===t||"row"===l||"rows"===l)return!0;if(!0===(s="startCol"in r?"endCol"in r?t>=r.startCol&&t<=r.endCol:t===r.startCol:s))return s}}return!1},update:function(){for(var e=this._selections,t=0,n=e.length;t<n;t++)this.updateSelection(e[t],null,e[t].forceType);return this},updateSelectionRect:function(e){return e.dom.css({top:e.size.top-1,left:e.size.left-1,outerWidth:e.size.width+1,outerHeight:e.size.height+1}),this},updateCurrentCell:function(e,t){this.grid;return this._currentCell=null!==e?{row:e,col:t}:null,this},updateSelectionMark:function(e){var t=this,n=t.grid,i=n.DOMMap;1===t._selections.length&&"row"!==t._mode&&"rows"!==t._mode&&t.grid.selectionMarked()?(i.columnSelection||(i.columnSelection=newDiv("_selection").appendTo(i.dataColumns)),i.viewSelection||(i.viewSelection=newDiv("_selection").appendTo(i.viewBodyRows)),i.columnSelection.css({left:e.size.left-1,width:e.size.width+1}),t._markedRows={startRow:e.range.startRow,endRow:"endRow"in e.range?e.range.endRow:e.range.startRow},t.markColumn(),n._viewBody.updateRowMark()):t.clearMarked()},updateSelectionByMergedCells:function(e){function t(e){var n=o._mergedCells._cells[e].range,e=i.rangeOverlap(n.startRow,n.endRow,r.startRow,r.endRow),t=i.rangeOverlap(n.startCol,n.endCol,r.startCol,r.endCol);e&&t&&Std.each("startRow startCol endRow endCol",function(e,t){r[t]=Math[e<2?"min":"max"](n[t],r[t])})}for(var i=this,o=i.grid,r=e.range,n=0,l=o._mergedCells.length;n<l;n++)t(n);for(n=l-2;0<=n;n--)t(n)},updateSelection:function(n,i,e){var t=this;return"endRow"in(i=null==i?n.range:i)&&i.endRow<i.startRow&&(i.endRow=[i.startRow,i.startRow=i.endRow][0]),"endCol"in i&&i.endCol<i.startCol&&(i.endCol=[i.startCol,i.startCol=i.endCol][0]),Std.each("startRow startCol endRow endCol",function(e,t){t in i&&(n.range[t]=i[t])}),"cells"===n.type&&"column"!==e&&t.updateSelectionByMergedCells(n),n.size=t.computeRangeSize(n.type,n.range),t.updateSelectionMark(n),t.updateSelectionRect(n),t},clearMarked:function(){var e=this,t=e.grid,n=t.DOMMap;if(!0===e._columnMarked){for(var i=0,o=t.columnCount();i<o;i++)t._columns[i][0].removeClass("selected");e._columnMarked=!1}return n.columnSelection&&(n.columnSelection.remove(),delete n.columnSelection),n.viewSelection&&(n.viewSelection.remove(),delete n.viewSelection),e._markedRows=null,t._viewBody.updateRowMark(),e},clear:function(){for(var e=this,t=e._selections,n=0,i=t.length;n<i;n++)t[n].dom.remove();return e._markedRows=null,e._currentCell=null,e.clearMarked(),e.updateCurrentCell(null),t.clear(),e}},k:function(e,t,n){var i=this;i.grid=t,i.opts=n,i._mode=e,i._selections=[],i._markedRows=null,i._currentCell=null}}),Std.ui("Grid").childModules.style=Std.module({n:{initKeys:function(){var e=this.grid,t="."+e._identifier+" > table > tbody > tr > td >",e="."+e.opts.defaultClass;this._selectors=Std.extend({},{viewHeader:t+e+"_ViewHeader",viewHeaderColumns:t+e+"_ViewHeader > ._columns",viewHeaderColumn:t+e+"_ViewHeader > ._columns > ._column",viewHeaderCheckBox:t+e+"_ViewHeader > ._columns > ._column > .StdUI_Grid_CheckBox",dataHeader:t+e+"_DataHeader",dataHeaderColumns:t+e+"_DataHeader > ._columns",dataHeaderColumn:t+e+"_DataHeader > ._columns > ._column",dataHeaderColumnArrow:t+e+"_DataHeader > ._columns > ._column > ._arrow",viewBody:t+e+"_ViewBody",viewBodyRow:t+e+"_ViewBody > ._rows > ._row",viewBodyRowCheckBox:t+e+"_ViewBody > ._rows > ._row > ._cell > .StdUI_Grid_CheckBox",viewBodyCell:t+e+"_ViewBody > ._rows > ._row > ._cell",viewBodyRowExpander:t+e+"_ViewBody > ._rows > ._row > ._cell > ._expander",dataBodyPlaceHolder:t+e+"_DataBody > ._placeHolder",dataBodyRows:t+e+"_DataBody > ._rows",dataBodyRow:t+e+"_DataBody > ._rows > ._row",dataBodyRowCheckBox:t+e+"_DataBody > ._rows > ._row > .StdUI_Grid_CheckBox",dataBodyContent:t+e+"_DataBody > ._rows > ._row > ._content",dataBodyCells:t+e+"_DataBody > ._cells",dataBodyCell:t+e+"_DataBody > ._cells > ._cell",dataBodyCellContent:t+e+"_DataBody > ._cells > ._cell > ._content",dataBodyRowCells:t+e+"_DataBody > ._rows > ._row > ._cells",dataBodyRowCell:t+e+"_DataBody > ._rows > ._row > ._cells > ._cell",dataBodyRowCellContent:t+e+"_DataBody > ._rows > ._row > ._cells > ._cell > ._content"})}},i:{appendHeaderStyle:function(){var n=this,e=n.grid,t=e.opts,i=n._lines,o={},r=t.columnHeight-1,l=t.columnPadding;o.viewHeaderCheckBox={marginTop:(r-16)/2+"px"},o.viewHeaderColumns=o.dataHeaderColumns={height:r+"px"},o.viewHeaderColumn={height:r+"px"},o.dataHeaderColumn={height:r-2*l+"px",lineHeight:r-2*l+"px",textAlign:t.columnTextAlign,padding:l+"px"},o.dataHeaderColumnArrow={marginTop:(r-2*l)/2-3+"px"},t.columnSortable&&(o.dataHeaderColumn.cursor="pointer");for(var a=0,s=0,d=t.columnCount;a<d;a++){var c=e._columns[a],u=c.width(),h=c.visible();i[a]||(i[a]=newDiv("_line").appendTo(e.DOMMap.dataBodyLines)),n._css.append(n._selectors.dataHeaderColumn+a,{width:u-2-2*t.columnPadding+"px"}),h&&(s+=u),!1!==c.opts.verticalLine&&h?!0===t.verticalLine&&i[a].css("left",s-1):i[a].css("left",-99)}if(i.length>d)for(a=d;a<i.length;a++)i[a].remove(),i.remove(a);return Std.each(o,function(e,t){n._css.append(n._selectors[e],t)}),n},appendViewBodyStyle:function(){var n=this,e=n.grid.opts,t=e.rowHeight,i=n._selectors;return e.rowNumbers&&n._css.append(i.viewBodyCell+"._number",{width:e.rowNumberWidth-1+"px"}),e.rowLabels&&n._css.append(i.viewBodyCell+"._label",{width:e.rowLabelWidth-1+"px"}),e.rowCheckable&&n._css.append(i.viewBodyCell+"._checkbox",{width:e.rowCheckBoxWidth-1+"px"}),e.rowExtensible&&n._css.append(i.viewBodyCell+"._expander",{width:e.rowExpanderWidth-1+"px"}),Std.each({viewBodyRow:{height:t-1+"px",lineHeight:t-1+"px"}},function(e,t){n._css.append(i[e],t)}),n},appendDataBodyStyle:function(){for(var e,n=this,t=n.grid,i=t.opts,o=n._selectors,r=i.rowHeight,l=i.cellPadding,a=t.computeColumnsWidth(),s=0,d=i.columnCount;s<d;s++){var c=t._columns[s],u=c.cellCSS(),h={width:c.width()-1.1+"px"};c.visible()?isObject(u)&&Std.extend(h,u):h.display="none",n._css.append(o.dataBodyRowCell+s,h)}return Std.each({dataBodyPlaceHolder:{width:a+"px"},dataBodyCells:{textAlign:i.cellTextAlign},dataBodyCellContent:{padding:l+"px"},dataBodyRowCheckBox:{marginTop:(r-1-16)/2+"px"},dataBodyRow:(e={width:a+"px"},i.horizontalLine||(e.borderColor="transparent"),e),dataBodyRowCells:{width:a+"px",height:r-1+"px",lineHeight:r-1-2*l+"px",textAlign:i.cellTextAlign},dataBodyContent:(e={},i.horizontalLine||(e.borderColor="transparent"),e),dataBodyRowCell:{height:r-1+"px"},dataBodyRowCellContent:{height:r-1-2*l+"px",padding:l+"px"}},function(e,t){n._css.append(o[e],t)}),n}},j:{selector:function(e){return this._selectors[e]},update:function(){this._css.clear(),this.appendHeaderStyle(),this.appendDataBodyStyle(),this.appendViewBodyStyle()},destroy:function(){this._css.remove()}},k:function(e){this.grid=e,this._css=new Std.css,this._lines=[],this.initKeys()}}),Std.ui("Grid").childModules.container=Std.module({e:{items:null,itemRender:null,itemHeight:32,rangeHeight:0,autoClean:!1,container:null,deferRender:!0,scrollDelay:null,direction:"vertical",spacingClassName:"_spacing"},n:{init:function(){var e=this;e.opts.deferRender?e.initSpacings():e.renderItems(),e._ready=!0,e.updateScrollValue(),e.update(),e.initScrollEvent()},initScrollEvent:function(){function e(){t.updateScrollValue(),(t._timer=t.updateRangeIndex())&&t.updateCurrentRange(),"function"==typeof n.scroll&&n.scroll.call(t,t._scrollValue)}var t=this,n=t.opts;n.monitor.on("scroll",t._scrollEvent=function(){!1===n.scrollDelay?e():(null!==t._timer&&(clearTimeout(t._timer),t._timer=null),t._timer=setTimeout(e,n.scrollDelay))})}},i:{initSpacings:function(){var e=this.opts;e.autoClean&&e.container.append(this.createSpacing(0,0).dom),e.container.append(this.createSpacing(0,this.length-1).dom)},destroy:function(){var e=this,t=e.opts;return null!==e._timer&&(clearTimeout(e._timer),e._timer=null),t.monitor.off("scroll",e._scrollEvent),e.clear()},markItemHeight:function(e,t,n){var i=this,o=i.opts,r=i._itemsHeight,l=r.length;if(t===o.itemHeight)return i;if(!0===n)r.push({index:e,height:t});else if(!1===n){for(var a=0;a<l&&!(r[a].index>=e);a++);r.insert({index:e,height:t},a)}else{for(var a=0,s=!1;a<l;a++)if(r[a].index===e){r[a].height=t,s=!0;break}!1===s&&i.markItemHeight(e,t,!1)}return i},unmarkItemHeight:function(e){for(var t=this._itemsHeight,n=0,i=t.length;n<i;n++)if(t[n].index===e){t.remove(n);break}return this},computeItemTop:function(e){for(var t=this.opts,n=e*t.itemHeight,i=0,o=this._itemsHeight.length;i<o;i++){var r=this._itemsHeight[i];if(!(r.index<e))break;n+=r.height-t.itemHeight}return n},computeSpacingSize:function(e,t){var n=this.opts;if(t<e||-1===e&&-1===t)return 0;for(var i=(t-e+1)*n.itemHeight,o=0,r=this._itemsHeight.length;o<r;o++){var l=this._itemsHeight[o];if(l.index>=e&&l.index<=t)i=(i-=n.itemHeight)+l.height;else if(l.index>t)break}return i},createSpacing:function(e,t,n){var i=this,o=i.opts,o={children:[],startIndex:e,endIndex:t,dom:newDiv(o.spacingClassName)};return void 0===n||-1===n?i._spacings.push(o):i._spacings.insert(o,n),i.updateSpacingSize(o,i.computeSpacingSize(e,t)),o},findSpacing:function(e,t,n){for(var i=null,o=this._spacings,r=0,l=o.length;r<l;r++){if(e>=o[r].startIndex&&e<=o[r].endIndex){i=!0===t?r:o[r],isFunction(n)&&n.call(this,r,o[r]);break}if(o[r].startIndex>e)break}return i},fillSpacing:function(e,t,n,i){var o=this,r=o.opts,l=o._spacings[n],r=r.container;return void 0!==i?"first"===i?(r.insertBefore(e[0],l.dom),o.updateSpacing(l,l.startIndex+1,l.endIndex)):"last"===i&&(r.insertAfter(e[0],l.dom),o.updateSpacing(l,l.startIndex,l.endIndex-1)):(i=o.createSpacing(l.startIndex,t-1,n),o.updateSpacing(l,t+1,l.endIndex),r.insertBefore(i.dom,l.dom),r.insertBefore(e[0],l.dom)),o},updateScrollValue:function(){var e=this.opts;return"vertical"===e.direction?this._scrollValue=e.monitor.scrollTop():"horizontal"===e.direction&&(this._scrollValue=e.monitor.scrollLeft()),this},updateSpacing:function(e,t,n){var i=this,o=i.opts,r=i._spacings,l=r.last();return isNumber(e)&&(e=r[e]),(n=n<t&&l!==e?t=-1:n)>=i.length&&(n=i.length-1),-1!==t||-1!==n||o.autoClean||r[0]===e||l===e?(e.startIndex=t,e.endIndex=n,i.updateSpacingSize(e,i.computeSpacingSize(t,n))):i.removeSpacing(e),i},updateSpacingSize:function(e,t){function n(e,t){"vertical"===i.direction?e.height(t):"horizontal"===i.direction&&e.width(t)}var i=this.opts,o=e.children,r=o.length;if((e.size=t)<=5e6)0<r&&(Std.each(o,function(e,t){t.remove()}),o.clear()),n(e.dom,t);else{var l=Math.ceil(t/5e6);if(l<r)for(var a=r-l-1;0<=a;a--)o[a].remove(),o.remove(a);for(a=0;a<l;a++)o[a]||(o[a]=newDiv(i.spacingClassName).appendTo(e.dom)),n(o[a],t<5e6?t:5e6),t-=5e6;n(e.dom,"")}return this},updateSpacings:function(){for(var e=this.opts,t=this._spacings,n=e.direction,i=null,o=0,r=t.length;o<r;o++){var l=t[o];null!==i&&i.endIndex===l.startIndex+1&&(l.size+=i.size,l.startIndex=i.startIndex,"vertical"===n?l.dom.height(l.size):"horizontal"===n&&l.dom.width(l.size),this.removeSpacing(o--),r--),i=t[o]}return i},updateRangeIndex:function(){for(var e,t,n=this,i=n.opts,o=i.itemHeight,r=n._itemsHeight,l=n._scrollValue,a=0,s=0,d=0,c=-1,u=0,h=0,m=r.length;d<m;d++){var p=(e=r[d]).height,g=(e.index-1-c)*o+h;if(!(a+g<=l)){0<d&&d--;break}c=e.index,s=(a+=g)+(h=p)}for((c=c<=0?0:c)+1&&0<l-s&&(c+=t=Math.floor((l-s)/o),a+=t*o),h=s=0,u=c;d<m;d++)if(!(c>=(e=r[d]).index)){if(s+(h=e.index==u+1?e.height:(e.index-u)*o+e.height)>=l-a+i.rangeHeight)break;u=e.index,s+=h}return(u+=Math.ceil((l-a+i.rangeHeight-s)/o))>=n.length&&(u=n.length-1),(n._rangeStart!==c||n._rangeEnd!==u)&&(n._rangeEnd=u,n._rangeStart=c,!0)},updateCurrentRange:function(){var e=this,t=e.opts,n=e._items,i=e.computeItemTop(e._rangeStart);t.deferRender&&t.autoClean&&(e.clearRenderedItems(!0),e.updateSpacing(0,0,e._rangeStart-1),e.updateSpacing(1,e._rangeEnd+1,e.length-1));for(var o=e._rangeStart;o<=e._rangeEnd;o++)!t.deferRender||n[o].owner&&n[o].rendered||e.renderItem(o),isFunction(t.appear)&&t.appear.call(e,n[o].data,n[o].owner,o);return t.deferRender&&!t.autoClean&&e.updateSpacings(),isFunction(t.updateCurrentRange)&&t.updateCurrentRange.call(e,e._rangeStart,e._rangeEnd,i),e},renderItems:function(){for(var e=this,t=e.opts,n=e._items,i=0,o=e.length;i<o;i++){var r=e._items[i].data,r=t.itemRender(r,i);t.container.append(r[0]),n[i].owner=r.update(i),n[i].rendered=!0}return e},renderItem:function(i){var n,o=this,e=o.opts,t=o._items[i],r=t.data,l=t.owner="owner"in t?t.owner:e.itemRender(r,i);return t.rendered=!0,e.autoClean?(n=null,(r=o._renderedList).sort(function(e,t){return e.index-t.index}).each(function(e,t){if(t.index>i)return n=t.item}),l[0].insertBefore(null===n?o._spacings[1].dom:n.owner[0]),o._renderedLength=r.push({item:o._items[i],index:i})):null===o.findSpacing(i,!0,function(e,t){var n;i===t.startIndex?n="first":i===t.endIndex&&(n="last"),o.fillSpacing(l,i,e,n)})&&(o._items[i+1].owner?l[0].insertBefore(o._items[i+1].owner[0]):o._items[i-1].owner&&l[0].insertAfter(o._items[i-1].owner[0])),o},adjustIndex:function(n,i){for(var e=this,t=e._spacings,o=t.length-1;0<=o;o--){var r=t[o],l=r.startIndex,a=r.endIndex;n<l?"+"===i?(l++,a++):"-"===i&&(l--,a--):n<=l&&n<=a&&("+"===i?a++:"-"===i&&a--),e.updateSpacing(r,l,a)}return Std.each(e._renderedList.concat(e._itemsHeight),function(e,t){t.index>=n&&("+"===i?t.index++:"-"===i&&t.index--)}),e},removeSpacing:function(e){var t,n=this._spacings;return isNumber(e)?t=n[e]:e=n.indexOf(t=e),t.dom.remove(),this._spacings.remove(e),this},clearRenderedItems:function(e){for(var t=this,n=t._renderedLength-1;0<=n;n--){var i=t._renderedList[n],o=i.index;!0===e&&o>=t._rangeStart&&o<=t._rangeEnd||(t._renderedLength--,t._renderedList.remove(n),i.item.rendered=!1,i.item.owner.detach())}return t}},j:{indexOf:function(e,t){for(var n=t||0;n<this.length;n++)if(this._items[n].data===e)return n;return-1},rangeHeight:function(e){return this.opt("rangeHeight",e,function(){this._ready&&this.updateScrollValue().update()})},itemName2Index:function(e){var t=this._itemsMap;return e in t?this._items.indexOf(t[e]):-1},itemHeight:function(e){var n=this;return n.opt("itemHeight",e,function(){n._ready&&(Std.each(n._spacings,function(e,t){n.updateSpacing(t,t.startIndex,t.endIndex)}),n.updateScrollValue().update())})},items:function(n,e){var i=this,t=null;if("number"==typeof n)t=i._items[n]||null;else if("string"==typeof n)t=i._itemsMap[n]||null;else if(isFunction(n))return 0===i.length?null:Std.each(i._items,function(e,t){return n.call(i,e,t)},e);return t},reset:function(){var e=this,t=e.opts,n=e._items;e._itemsHeight.clear(),e._renderedList.clear(),e._renderedLength=0;for(var i=e._spacings.length-1;0<=i;i--)e.removeSpacing(i);for(i=0;i<e.length;i++){var o=n[i].data;n[i].owner&&(n[i].owner.destroy(),delete n[i].owner),"height"in o&&e._itemsHeight.push({index:i,height:o.height})}return t.deferRender?e.initSpacings():e.renderItems(),e},sort:function(n,i){return this._items.sort(function(e,t){return null==(e=i(e.data))||null==(t=i(t.data))?-1:"asc"===n?null==e||null==t?-1:("string"!=typeof e&&"string"!=typeof t||(e+"").localeCompare(t+""),t<e?1:e===t?0:-1):"desc"===n?null==e||null==t?-1:("string"!=typeof e&&"string"!=typeof t||(t+"").localeCompare(e+""),e<t?1:e===t?0:-1):void 0}),this.reset().updateScrollValue().update()},update:function(){return this.updateRangeIndex(),this.updateCurrentRange(),this},signin:function(e,t,n){return"name"in t&&(this._itemsMap[t.name]=n),("height"in t||t.expanded)&&(n="height"in t?t.height:this.opts.itemHeight,t.expanded&&(n+="contentHeight"in t?t.contentHeight:this.opts.parent.opts.rowContentHeight),n!==this.opts.itemHeight&&this.markItemHeight(e,n,e===this.length)),this.length++,this},insert:function(e,t){var n=this,i=n.opts,o=null,r=n._items,l=n._ready;return void 0===t||t<0||t>=n.length?n.append(e):(l&&n.adjustIndex(t,"+"),i.deferRender||!l?r.insert(o={data:e},t):(l=i.itemRender(e),r.insert(o={data:e,owner:l},t),i.container.insert(l[0],t+1)),n.signin(t,e,o)._ready?(!i.deferRender||i.autoClean||n.findSpacing(t)||n.renderItem(t),n.update()):n)},append:function(e){function t(e){var t,n=null;o.deferRender||!l?r.push(n={data:e}):(t=o.itemRender(e,i.length),r.push(n={owner:t,data:e}),t[0].appendTo(o.container)),i.signin(i.length,e,n)}var n,i=this,o=i.opts,r=i._items,l=i._ready;if(isArray(e))for(var a=0,s=e.length;a<s;a++)t(e[a]);else isObject(e)&&t(e);return l&&(o.deferRender&&!o.autoClean&&(n=i._spacings.last(),i.updateSpacing(n,n.startIndex,i.length-1)),i.update()),i},remove:function(e){function n(e){r<=e||(o[e].owner&&o[e].owner.destroy(),"name"in o[e].data&&delete t._itemsMap[o[e].data.name],t.length--,t.unmarkItemHeight(e),o.remove(e),i.deferRender&&t._ready&&t.adjustIndex(e,"-"))}var t=this,i=t.opts,o=t._items,r=t.length;return void 0===e?t.destroy():(isNumber(e)?n(e):isArray(e)&&e.sort(function(e,t){return t-e}).each(function(e,t){n(t)}),t._ready&&t.update(),t)},clear:function(){var e=this,t=e.opts;0<e._renderedLength&&e.clearRenderedItems();for(var n=0;n<e.length;n++)e._items[n].owner&&e._items[n].owner.destroy();for(n=e._spacings.length-2;0<=n;n--)0===n&&t.deferRender&&!t.autoClean&&e.removeSpacing(n);return Object.clear(e._itemsMap),e._items.clear(),e._itemsHeight.clear(),e.length=0,e}},k:function(e){var t=this,e=t.init_opts(e);t.length=0,t._ready=!1,t._timer=null,t._rangeStart=-1,t._rangeEnd=-1,t._items=e.items,t._itemsMap={},t._spacings=[],t._itemsHeight=[],t._renderedList=[],t._renderedLength=0,t._scrollValue=0}}),Std.ui("Grid").childModules.ViewBody=Std.module({n:{initDOMTree:function(){var e=this.grid,t=e.DOMMap;t.body.prepend(t.viewBodyTD=newDom("td").append(t.viewBody=newDiv(e.opts.defaultClass+"_ViewBody").append(t.viewBodyRows=newDiv("_rows").append(t.viewBodySpacing=newDiv("_spacing")))))},initCheckboxEvents:function(){function t(e){var t=!this.hasClass("checked"),n=this.parent("._row").data("viewRow").index;return(n=o._items[n]).owner&&"checked"===i.opts.selectionMode&&n.owner[0].toggleClass("selected",t),this.toggleClass("checked",n.data.checked=t),!1}function n(){for(var e=this.hasClass("checked"),t=0,n=o._items.length;t<n;t++)o._items[t].data.checked=!e;this.toggleClass("checked",!e),o.update()}var i=this.grid,e=i.DOMMap,o=i._container;e.viewColumns.on("mouseenter",">._column > .StdUI_Grid_CheckBox",function(e){this.mouse({auto:!1,click:n},e)}),e.viewBodyRows.on("mouseenter"," >._row > ._cell._checkbox > .StdUI_Grid_CheckBox",function(e){this.mouse({auto:!1,down:Std.func(!1),click:t},e)})},initExpanderEvents:function(){function t(e){var t=this.parent("._row").data("viewRow"),n=t.index,i=l.row(n),o=a._items[n].owner;return this.toggleClass("_expanded",i.expanded=!this.hasClass("_expanded")),o.update(n),l._selection.update(),r.updateViewRow(t,o),l._mergedCells.update(),r.updateRowMark(),!1}var r=this,l=r.grid,e=l.DOMMap,a=l._container;e.viewBodyRows.on("mouseenter",">._row > ._cell._expander > ._expander",function(e){this.mouse({auto:!1,down:Std.func(!1),click:t},e)})},initRowEvents:function(){var i=this.grid,o=i.DOMMap;o.viewBodyRows.on("mouseenter mouseleave mousedown click","> ._row",function(e){var t=this.data("viewRow"),t=i._container.items(t.index).owner[0];if(e.viewRow=!0,"mousedown"===e.name){e.preventDefault();var n=o.viewBodyRows.plugin("resize");if(n&&0!==n.cursorCode)return}"mouseenter"===e.name?t.fireEvent("mouseover",e):"mouseleave"===e.name?t.fireEvent("mouseout",e):t.fireEvent(e.name,e)})}},i:{width:function(){var e=this.grid.opts,t=0;return e.rowNumbers&&(t+=e.rowNumberWidth),e.rowCheckable&&(t+=e.rowCheckBoxWidth),e.rowLabels&&(t+=e.rowLabelWidth),e.rowExtensible&&(t+=e.rowExpanderWidth),t},height:function(e){var t=this.grid.DOMMap;return void 0===e?t.viewBody.height():(t.viewBody.height(e),t.viewBodySpacing.height(e),this)},updateWidth:function(){var e=this.grid.DOMMap,t=this.width();return e.viewBody.width(t),e.viewBodyRows.width(t),e.viewBodySpacing.width(t-1),this},clear:function(){for(var e=this._rows,t=0,n=e.length;t<n;t++)e[t].row.remove();return e.clear(),this}},j:{updateRowMark:function(e){var t=this.grid,n=t.DOMMap,i=this._rows,o=t._selection._markedRows;if(void 0===e){for(var r,l=0,a=i.length,s=!1,d=0,c=0;l<a;l++)this.updateRowMark(l)&&o&&(r="height"in i[l]?i[l].height:t.opts.rowHeight,i[l].marked&&(s=!0,c+=r),!1===s&&(d+=r));o&&n.viewSelection.css({top:d-1,height:c+1})}else{n=i[e];o&&n.index>=o.startRow&&n.index<=o.endRow?n.marked||(n.row.addClass("selected"),n.marked=!0):n.marked&&(n.row.removeClass("selected"),delete n.marked)}return this},updateViewRow:function(e,t){var n=this.grid.opts,i=e.index,o=t.height();(e.expanded=t.expanded())&&(o+=t.contentHeight()),n.rowHeight!==o?e.row.height((e.height=o)-1).lineHeight(o-1):"height"in e&&(e.row.removeStyle("height lineHeight"),delete e.height),n.rowNumbers&&(e.numberCell||e.row.prepend(e.numberCell=newDiv("_cell _number")),e.number!==i+1&&e.numberCell.html(e.number=i+1)),n.rowCheckable&&(e.checkboxCell||e.row.append(e.checkboxCell=newDiv("_cell _checkbox").append(e.checkbox=newDiv("StdUI_Grid_CheckBox"))),e.checkbox.toggleClass("checked",!!t.checked())),n.rowLabels&&(e.labelCell||e.row.append(e.labelCell=newDiv("_cell _label")),e.label!==t.label()&&e.labelCell.html(t.label())),n.rowExtensible&&(e.expander||e.row.append(e.expanderCell=newDiv("_cell _expander").append(e.expander=newDiv("_expander"))),e.expander.toggleClass("_expanded",e.expanded))}},k:function(e){this.grid=e,this._rows=[]}}),Std.ui("Grid").childModules.plugin=Std.module({n:{initRowContextMenu:function(){var e=this.grid,t=e.DOMMap.tbody.plugin("contextMenu",{handle:"> tr > td > .StdUI_Grid_DataBody > ._rows > ._row",menu:e.opts.rowContextMenu});e.DOMMap.viewBodyRows.on("contextmenu","> ._row",function(e){return t.show().move(e.pageX+1,e.pageY+1),!1})},initCellContextMenu:function(){var e=this.grid,t=e.opts;e.DOMMap.body.plugin("contextMenu",{handle:"> td > .StdUI_Grid_DataBody > ._rows > ._row > ._cells > ._cell,> td > .StdUI_Grid_DataBody > ._cells > ._cell",menu:t.cellContextMenu})},initColumnContextMenu:function(){var e=this.grid,t=e.opts;e.DOMMap.dataColumns.plugin("contextMenu",{handle:"> ._column",menu:t.columnContextMenu})},initRowResizePlugin:function(){var n=this,i=n.grid,t=i.opts,o=0,r=0,l=0;i.DOMMap.viewBodyRows.plugin("resize",{top:!1,left:!1,right:!1,items:"> ._row",cursor:"row-resize",helper:"original",opacity:1,minHeight:2*t.cellPadding,check:function(e){return t.rowResizable&&!e.data("viewRow").expanded}}).on({start:function(e){var t=e.self.data("viewRow");o=e.e.pageY,l=e.self.height(),n.createResizer("horizontal").css("top",r=e.self.offset().y-i[0].offset().y+l-1),i.emit("rowResizeStart",t.index)},stop:function(e){var t=e.self.data("viewRow");i._container.items(t.index).owner.height(t.height=e.height),i._container.markItemHeight(t.index,e.height).update(),i._selection.update(),i._mergedCells.update(),i.DOMMap.resizer.remove(),i.emit("rowResizeStop",t.index)},move:function(e){l+(e.e.pageY-o)>2*t.cellPadding&&(e.self.lineHeight(e.self.height()),i.DOMMap.resizer.css("top",r+(e.e.pageY-o)))}})},initColumnResizePlugin:function(){var t=this,n=t.grid,i=n.opts,o=null,r=0,l=0,a=0,s=-1;n.DOMMap.dataColumns.plugin("resize",{top:!1,left:!1,bottom:!1,opacity:1,items:"> ._column",cursor:"col-resize",helper:"original",minWidth:2*i.columnPadding,check:function(e,t){if(!n.column(e.index()).resizable())return t.stopFire(),!1}}).on({start:function(e){r=e.e.pageX,o=n.column(s=e.self.index()),a=e.self.width()+2*i.columnPadding,t.createResizer("vertical").css("left",l=e.self.offset().x-n[0].offset().x+a),n.emit("columnResizeStart",s)},stop:function(e){o.width(e.width),n._selection.update(),n._mergedCells.update(),n.DOMMap.resizer.remove(),n.emit("columnResizeStop",s)},move:function(e){a+(e.e.pageX-r)>2*i.columnPadding&&n.DOMMap.resizer.css("left",l+(e.e.pageX-r))}})},initColumnDropPlugin:function(){var n=this.grid,i=n.opts,o=null,t=null,r="",l=null,a=null,s=-1;n.DOMMap.dataColumns.plugin("drop",{items:"> ._column",accept:n._style.selector("dataHeaderColumn"),helper:"rect",helperClass:"StdUI_Grid_ColumnHelper",placeHolder:"clone",forcePlaceHolderSize:!1,check:function(e,t){if(!n.column(e.index()).droppable())return t.stopFire(),!1}}).on({leave:function(){o.hide(),a=null},start:function(e){var t=Std.ui.status.zIndex+1;e.helper.html((l=n._columns[s=e.self.index()]).text()).css({zIndex:t,lineHeight:e.height-2,textIndent:i.columnPadding+"px"}),(o=new Std.doms(".StdUI_Grid_ColumnPointer._top,.StdUI_Grid_ColumnPointer._bottom").appendTo("body"))[0].css("zIndex",t),o[1].css("zIndex",t),n.emit("columnDropStart",s)},enter:function(e){(t=e.containment.offset())&&(a=n._columns[e.containment.index()])!==l&&(o.show(),o[0].css("top",t.y-10),o[1].css("top",t.y+e.containment.outerHeight()))},move:function(e){e.containment&&a&&(e.pageX<t.x+a.width()/2&&(r="before")?o.left(t.x-6):(r="after",o.left(t.x+a.width()-6)))},stop:function(e){o.remove(),e.containment&&r&&l&&a&&(n.moveColumn(l,a,r),n._selection.clear()),n.emit("columnDropStop",s)}})}},protected:{createResizer:function(e){var t=this.grid,e=t.DOMMap.resizer=newDiv("_resizer _"+e);return e.appendTo(t[0]),e}},k:function(e){this.grid=e}});
"undefined;"